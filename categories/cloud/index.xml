<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Cloud on Thomas Labarussias</title><link>https://thomas.labarussias.fr/categories/cloud/</link><description>Recent content in Cloud on Thomas Labarussias</description><generator>Hugo -- gohugo.io</generator><language>fr</language><lastBuildDate>Thu, 17 Jun 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://thomas.labarussias.fr/categories/cloud/index.xml" rel="self" type="application/rss+xml"/><item><title>Le FinOps</title><link>https://thomas.labarussias.fr/posts/finops/</link><pubDate>Thu, 17 Jun 2021 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/posts/finops/</guid><description>&lt;h2 id="avant-propos">Avant-propos
&lt;/h2>&lt;p>Durant mon exp√©rience professionnelle pr√©c√©dente, j&amp;rsquo;ai exerc√© pendant 3 ans en tant qu&amp;rsquo;expert &lt;strong>FinOps&lt;/strong> sur &lt;strong>AWS&lt;/strong>. La fonction ayant √©t√© cr√©√©e avec moi, j&amp;rsquo;ai eu toute libert√© pour mettre en place le mod√®le que je souhaitais, avec sa m√©thodologie et ses outils.
Avant d&amp;rsquo;oublier ce que je sais, je me suis dit qu&amp;rsquo;il serait peut-√™tre int√©ressant pour certains que je mette ce qui me reste en t√™te par √©crit, la litt√©rature en fran√ßais se faisant rare d&amp;rsquo;autant plus (si l&amp;rsquo;article pla√Æt, je ferai peut-√™tre une traduction en anglais).&lt;/p>
&lt;p>Il m&amp;rsquo;√©tait √©galement apparu, en discutant avec mes clients et d&amp;rsquo;autres experts, souvent issus d&amp;rsquo;entreprises de conseils, que ma vision pouvait diff√©rer de la leur et de ce qu&amp;rsquo;on trouve g√©n√©ralement dans les articles traitant du sujet. Je pense que cela vient du fait que je suis avant tout un &lt;em>OPS&lt;/em>, g√©rant une production et les contraintes inh√©rentes. Mes recommandations et conseils ont toujours eu pour trame de fond une vraie exploitation des plateformes, de leurs performances et disponibilit√©s (travaillant pour un infog√©rant, si la plateforme tombait, c&amp;rsquo;√©taient mes coll√®gues et moi qui r√©glons les probl√®mes, possiblement en astreinte üòâ ).&lt;/p>
&lt;p>N&amp;rsquo;ayant de connaissances avanc√©es et n&amp;rsquo;ayant effectu√© des audits uniquement pour &lt;em>AWS&lt;/em>, j&amp;rsquo;utiliserai dans cet article beaucoup de termes et conseils li√©s √† ce &lt;em>Cloud Provider&lt;/em>, mais je pense que les √©l√©ments g√©n√©raux sont facilement transposables √† &lt;em>GCP&lt;/em> et &lt;em>Azure&lt;/em>.&lt;/p>
&lt;hr>
&lt;h2 id="d√©finition">D√©finition
&lt;/h2>&lt;p>La premi√®re des t√¢ches est bien entendu de d√©finir le terme de &lt;strong>FinOps&lt;/strong> lui-m√™me. Il appara√Æt √©videmment qu&amp;rsquo;il est la contraction de deux termes (comme tous ces &lt;strong>TrucOps&lt;/strong> √† la mode üòõ).
Dans notre cas: &lt;strong>Financial&lt;/strong> + &lt;strong>Operations&lt;/strong>.
Pas tr√®s parlant au demeurant, on s&amp;rsquo;attend plus √† de la comptabilit√© qu&amp;rsquo;√† de l&amp;rsquo;architecture &lt;em>Cloud&lt;/em>.&lt;/p>
&lt;p>Voil√† donc ma d√©finition, avec des morceaux en gras et ce, √† dessein:&lt;/p>
&lt;blockquote>
&lt;p>Le &lt;strong>FinOps&lt;/strong> &lt;strong>analyse les architectures&lt;/strong> Cloud et leurs &lt;strong>facturations associ√©es&lt;/strong>, afin de d√©gager des &lt;strong>axes de limitations des co√ªts et/ou d‚Äô√©conomie&lt;/strong>, en assurant &lt;strong>un niveau de risque faible&lt;/strong> et en prenant en compte les &lt;strong>enjeux de l&amp;rsquo;entreprise&lt;/strong>.&lt;/p>&lt;/blockquote>
&lt;p>Reprenons chacune des parties mises en exergue:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>analyse les architectures&lt;/strong>: Le travail de &lt;em>FinOps&lt;/em> est un travail d&amp;rsquo;ing√©nierie avant tout, si on se contente de pointer des lignes dans une feuille &lt;em>Excel&lt;/em> pour trouver les services co√ªtant trop chers dans lesquels il faudrait tailler, cela ne marchera pas.&lt;/li>
&lt;li>&lt;strong>facturations associ√©es&lt;/strong>: On enfonce une porte ouverte, mais il va de soit que pour cibler les axes d&amp;rsquo;am√©liorations, il faut savoir quels sont les services qui sont factur√©s et dans quelles mesures (r√©duire de 10% le co√ªt d&amp;rsquo;un service √† $100 reste moins int√©ressant avant que 2% d&amp;rsquo;un service √† $1000, par exemple).&lt;/li>
&lt;li>&lt;strong>axes de limitations des co√ªts et/ou d‚Äô√©conomie&lt;/strong>: La distinction est tr√®s importante √† mon sens. On cherche souvent √† seulement diminuer les co√ªts, mais il faut aussi penser √† faire en sorte de contr√¥ler leurs √©volutions. J&amp;rsquo;ai souvent expliqu√© qu&amp;rsquo;une facture de &lt;em>Cloud Provider&lt;/em> qui augmente, ce n&amp;rsquo;est pas forc√©ment anormal ou g√™nant, cela peut juste √™tre la cons√©quence logique de l&amp;rsquo;augmentation de l&amp;rsquo;activit√©. Vous avez plus de trafic, et donc plus de consommation mais surtout plus de chiffre d&amp;rsquo;affaires, ce qui est attendu. L√† o√π √ßa coince c&amp;rsquo;est quand la facture augmente alors que le CA baisse, ou bien que les deux croissent tous deux mais dans des ordres de grandeur tr√®s diff√©rents (co√ªts qui explosent par rapport aux revenus).&lt;/li>
&lt;li>&lt;strong>un niveau de risque faible&lt;/strong>: Quand on met en place des actions &lt;em>FinOps&lt;/em>, on pense souvent √† changer les types des Instances (&lt;em>VM&lt;/em>), ou √† r√©-architecturer des portions de la plateforme. Il est alors tr√®s important de garder √† l&amp;rsquo;esprit que la plateforme doit assurer un service de m√™me qualit√© (voire plus), et il faut donc √™tre tr√®s prudent dans les choix et leurs mises en place.&lt;/li>
&lt;li>&lt;strong>enjeux de l&amp;rsquo;entreprise&lt;/strong>: Une plateforme &lt;em>Cloud&lt;/em> n&amp;rsquo;est apr√®s-tout qu&amp;rsquo;un outil, un moyen de d√©livrer un service, elle s&amp;rsquo;inscrit dans un cadre beaucoup plus vaste √† prendre en compte. Je pense par exemple √† la maturit√© de l&amp;rsquo;entreprise avec les technologies, ou bien aux contraintes l√©gales (&lt;em>PCI-DSS&lt;/em>, &lt;em>HADS&lt;/em>, etc).&lt;/li>
&lt;/ul>
&lt;h2 id="trouver-le-bon-dosage-entre-ha-perfs-et-co√ªts">Trouver le bon dosage entre HA, Perfs et Co√ªts
&lt;/h2>&lt;p>Fort de cette d√©finition, il convient d√©sormais d&amp;rsquo;expliciter ce qu&amp;rsquo;on vise en faisant du &lt;strong>FinOps&lt;/strong>, ce qui va guider nos choix.&lt;/p>
&lt;p>Il s&amp;rsquo;agit de trouver le bon dosage entre 3 crit√®res:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Haute-disponibilit√©&lt;/strong>&lt;/li>
&lt;li>&lt;strong>Performances&lt;/strong>&lt;/li>
&lt;li>&lt;strong>Co√ªts&lt;/strong>&lt;/li>
&lt;/ul>
&lt;p>Les 3 s&amp;rsquo;influencent bien √©videmment mutuellement.&lt;/p>
&lt;p>Par exemples:&lt;/p>
&lt;ul>
&lt;li>Si la &lt;strong>HA&lt;/strong> est un crit√®re dominante, les co√ªts vont forc√©ment grimper et les performances peuvent baisser &lt;em>(multi-r√©gions, multi-cloud)&lt;/em>.&lt;/li>
&lt;li>Si on privil√©gie les &lt;strong>performances&lt;/strong>, des machines plus grosses seront √† payer mais la &lt;strong>HA&lt;/strong> pourra √™tre sacrifi√©e √©galement &lt;em>(j&amp;rsquo;ai eu un client qui faisait tout tourner sur une seule AZ AWS car les latences entre les datacenters AWS avaient un impact sur sa grille de calcul)&lt;/em>.&lt;/li>
&lt;li>Si on cherche absolument √† baisser les co√ªts, on sacrifiera les &lt;strong>performances&lt;/strong> et/ou la &lt;strong>haute-disponibilit√©&lt;/strong>.&lt;/li>
&lt;/ul>
&lt;h3 id="un-autre-crit√®re-√†-prendre-en-compte-la-s√©curit√©">Un autre crit√®re √† prendre en compte: la S√©curit√©
&lt;/h3>&lt;p>J&amp;rsquo;ai volontairement omis de rajouter ce 4√®me crit√®re dans la liste pr√©c√©dente, car il est particulier et √† toute son importance. Il impacte potentiellement les 3 autres crit√®res et s&amp;rsquo;inscrit dans un cadre plus important tr√®s souvent impossible √† n√©gliger (&lt;em>PCI-DSS&lt;/em>, &lt;em>HADS&lt;/em>, etc). Il faut donc veiller √† ce que les recommandations s&amp;rsquo;inscrivent dans les bonnes pratiques de s√©curit√©, voire dans le cadre de la loi.&lt;/p>
&lt;h3 id="ajuster-ses-crit√®res">Ajuster ses crit√®res
&lt;/h3>&lt;p>Il ressort de tout cela une bonne nouvelle, c&amp;rsquo;est que nous sommes dans le cadre d&amp;rsquo;une plateforme &lt;em>Cloud&lt;/em>, qui vient avec ses contraintes mais aussi ses avantages, avec en t√™te de la liste la flexibilit√©.&lt;/p>
&lt;p>J&amp;rsquo;ai mentionn√© pr√©c√©demment que tout l&amp;rsquo;art du &lt;em>FinOps&lt;/em> √©tait de trouver le bon dosage entre les &lt;em>perfs&lt;/em>, la &lt;em>HA&lt;/em> et les &lt;em>co√ªts&lt;/em>, et ce qu&amp;rsquo;il y a de &lt;em>magique&lt;/em> avec le &lt;em>Cloud&lt;/em>, c&amp;rsquo;est que ce dosage n&amp;rsquo;est pas vou√© √† √™tre immuable et universel. La souplesse des &lt;em>Cloud Providers&lt;/em> permet d&amp;rsquo;ajuster la balance comme on le souhaite et quand on le souhaite.&lt;/p>
&lt;p>Voici une liste d&amp;rsquo;√©l√©ments pouvant amener √† adapter notre choix du ou des crit√®res dominants, avec quelques exemples pour les expliciter:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Environnement&lt;/strong>: On accorde souvent plus d&amp;rsquo;importance √† la disponibilit√© de l&amp;rsquo;environnement de production qu&amp;rsquo;√† celui de staging.&lt;/li>
&lt;li>&lt;strong>P√©riode&lt;/strong>: En e-commerce, on mettra le paquet en p√©riode de soldes. Une application de facturation n&amp;rsquo;a besoin d&amp;rsquo;√™tre gonfl√©e aux st√©ro√Ødes qu&amp;rsquo;en d√©but ou fin de mois, etc.&lt;/li>
&lt;li>&lt;strong>Criticit√© des donn√©es&lt;/strong>: On peut parfois se permettre de perdre du cache, mais pas des donn√©es m√©tier.&lt;/li>
&lt;li>&lt;strong>Criticit√© de l&amp;rsquo;application&lt;/strong>: Un SSO sera central, alors qu&amp;rsquo;un &lt;em>worker&lt;/em> qui tombe ne cr√©e que du d√©lai et sa t√¢che sera cens√©e √™tre reprise ensuite.&lt;/li>
&lt;li>&lt;strong>Enjeux Business&lt;/strong>: Respect des SLA de disponibilit√© ou de performance.&lt;/li>
&lt;li>&lt;strong>Budget&lt;/strong>: Une lev√©e de fond permet souvent d&amp;rsquo;apporter les modifications voulues ou √† l&amp;rsquo;inverse, un trou dans la tr√©sorerie imposera de sacrifier tel ou tel crit√®re.&lt;/li>
&lt;/ul>
&lt;h2 id="co√ªts-et-mod√®les-de-facturation">Co√ªts et mod√®les de facturation
&lt;/h2>&lt;p>Il est extr√™mement important d&amp;rsquo;avoir √† l&amp;rsquo;esprit de quoi sont compos√©es les factures mais aussi le contexte global dans lesquelles elles s&amp;rsquo;inscrivent.&lt;/p>
&lt;p>Je d√©gage donc 2 axes, les co√ªts &lt;em>Directs&lt;/em> et les co√ªts &lt;em>Indirects&lt;/em>.&lt;/p>
&lt;p>On ne pourra pas jouer sur les deux de la m√™me fa√ßon, voire pas du tout pour certains √©l√©ments. Et il est tr√®s important de tous les prendre en compte dans les choix des actions √† mener.&lt;/p>
&lt;h3 id="les-co√ªts-directs">Les co√ªts Directs
&lt;/h3>&lt;p>Je classe parmi les co√ªts &lt;em>Directs&lt;/em> tout ce qui est directement dans la facture du &lt;em>Cloud Provider&lt;/em>, en s√©parant en 2 cat√©gories:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Ressources&lt;/strong>: Ce sont les co√ªts dans les factures les plus simples √† comprendre et estimer, g√©n√©ralement factur√©s √† la seconde ou heure, ils caract√©risent les √©l√©ments &amp;ldquo;immobilis√©s&amp;rdquo; pour composer l&amp;rsquo;infrastructure (&lt;em>Instances&lt;/em>, &lt;em>Volumes&lt;/em>, etc). La r√®gle est simple, plus on prend gros, plus on paye cher, et inversement. On peut donc facilement estimer les √©conomies possibles quand on agit sur elles.&lt;/li>
&lt;li>&lt;strong>Consommations&lt;/strong>: Ce sont tous les co√ªts dans les factures plus difficiles √† estimer car ind√©pendant de nos propres choix et variant du tout ou tout entre les p√©riodes. On y classe la bande passante, les snapshots, le nombre total de requ√™tes, etc. Les estimations d&amp;rsquo;√©conomies sont souvent moins pr√©cises mais en connaissant bien son activit√© et en prenant quelques marges, on y arrive.&lt;/li>
&lt;/ul>
&lt;h3 id="les-co√ªts-indirects">Les co√ªts Indirects
&lt;/h3>&lt;p>Quand on pense √† r√©duire sa facture &lt;em>Cloud&lt;/em> on oublie bien souvent les co√ªts annexes qui n&amp;rsquo;apparaissent pas √† proprement parl√© sur la facture mais qui sont pourtant bien l√† quand on veut mettre en place des actions:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Co√ªts de migration&lt;/strong>: Si vous pr√©voyez de remplacer des morceaux ou de partir sur une nouvelle architecture, il sera n√©cessaire de passer un grand nombre de &lt;em>JH&lt;/em> (jour-homme) sur le sujet, et cela aura un co√ªt pour votre organisation, tant financier qu&amp;rsquo;humain. Le retour sur investissements se doit donc d&amp;rsquo;√™tre int√©ressant.&lt;/li>
&lt;li>&lt;strong>Co√ªts de d√©veloppement&lt;/strong>: Dans la m√™me id√©e, moins &lt;em>OPS&lt;/em> et plus &lt;em>DEV&lt;/em>, si vous changez de technologie, il y aura s√ªrement du code √† √©crire et donc du &lt;em>JH&lt;/em> √† passer, sur des fonctionnalit√©s qui n&amp;rsquo;apportent pas forc√©ment une plus-value pour le client final.&lt;/li>
&lt;li>&lt;strong>Formation&lt;/strong>: Un point √† ne jamais n√©gliger, tout changement sera mieux v√©cu s&amp;rsquo;il est accompagn√© par une formation, qu&amp;rsquo;elle soit interne ou non (c&amp;rsquo;est souvent plus cher avec des consultants ext√©rieurs, bien entendu).&lt;/li>
&lt;li>&lt;strong>Infog√©rance&lt;/strong>: Si vous ne g√©rez pas vous-m√™me votre plateforme, ou si vous avez souscrit un contrat pour avoir du 24/7, le p√©rim√®tre financier peut √™tre impact√©.&lt;/li>
&lt;li>&lt;strong>Licences&lt;/strong>: C&amp;rsquo;est un point surtout valable pour les migrations d&amp;rsquo;&lt;em>On-Premise&lt;/em> vers du &lt;em>Cloud&lt;/em>, les mod√®les de facturation des licences √©diteurs pouvant beaucoup changer, et pas forc√©ment √† la baisse.&lt;/li>
&lt;/ul>
&lt;p>Ces co√ªts &lt;em>Indirects&lt;/em> sont bien souvent plus difficiles √† √©valuer, voire quasi impossibles quand vous √™tes un auditeur externe, mais il est important de prendre en compte le fait qu&amp;rsquo;ils existent et peuvent drastiquement changer le choix des actions √† mener.&lt;/p>
&lt;h2 id="finops-un-processus">FinOps, un processus
&lt;/h2>&lt;p>Maintenant que nous avons la destination, voyons le chemin. A mon sens, le &lt;em>FinOps&lt;/em> est un processus qui se d√©roulera toute la vie de la plateforme et d√©bute √† sa conception. Il appara√Æt bien souvent que r√©fl√©chir √† une architecture en int√©grant les aspects &lt;em>FinOps&lt;/em> d√®s le d√©but, am√®ne √† cr√©er des conceptions plus proches des bonnes pratiques.&lt;/p>
&lt;p>Ce processus √† plusieurs caract√©ristiques, il est:&lt;/p>
&lt;ul>
&lt;li>&lt;em>Continue&lt;/em>&lt;/li>
&lt;li>&lt;em>It√©ratif&lt;/em> (une action apr√®s l&amp;rsquo;autre)&lt;/li>
&lt;li>&lt;em>A complexit√© croissante&lt;/em> (voire exponentielle)&lt;/li>
&lt;/ul>
&lt;p>Ce processus, peut varier d&amp;rsquo;une entreprise √† l&amp;rsquo;autre, mais on retrouve g√©n√©ralement 3 √©tapes cl√©s, se r√©p√©tant:&lt;/p>
&lt;blockquote>
&lt;p>Analyse &amp;gt; Recommandations &amp;gt; Mise en place &amp;gt; Analyse &amp;gt; &amp;hellip;&lt;/p>&lt;/blockquote>
&lt;h3 id="un-processus-continue">Un processus continue
&lt;/h3>&lt;p>Les architectures &lt;em>Cloud&lt;/em> √©tant √©lastiques, les facturations associ√©es le sont tout autant. A cela s&amp;rsquo;ajoute que le tout virtualis√©, pay√© √† la consommation, rend les architectures mutables (changement de types de machines, remplacement de briques par d&amp;rsquo;autres services, etc). Il appara√Æt alors √©vident que mener des actions &lt;em>FinOps&lt;/em> une fois tous les trimestres, par exemple, sera moins pertinent, et pire, √† la tra√Æne vis-√†-vis des d√©penses.&lt;/p>
&lt;p>Il est important d&amp;rsquo;int√©grer le &lt;em>FinOps&lt;/em> parmi tous les autres processus permettant de g√©rer correctement une plateforme, voire m√™me d&amp;rsquo;int√©grer des points de contr√¥le au m√™me titre que nous mettons en place du &lt;em>monitoring&lt;/em> pour les syst√®mes eux-m√™mes. Les &lt;em>Cloud Providers&lt;/em> ne s&amp;rsquo;y sont pas tromp√©s et fournissent des moyens de v√©rifier le respect d&amp;rsquo;un budget (sans jamais bloquer les possibles d√©penses, on parle juste d&amp;rsquo;alertes). Cela rentre dans la partie de ma d√©finition: &lt;code>limiter les co√ªts&lt;/code>.&lt;/p>
&lt;p>Cela n&amp;rsquo;√©carte pas les audits plus profonds pouvant √™tre men√©s, non pas au jour le jour, mais tout de m√™me r√©guli√®rement, et qui eux servent souvent √† d√©gager les axes d&amp;rsquo;√©conomies plus importantes.&lt;/p>
&lt;h3 id="un-processus-it√©ratif">Un processus it√©ratif
&lt;/h3>&lt;p>Une fois qu&amp;rsquo;une analyse &lt;em>FinOps&lt;/em> a √©t√© men√©e √† bien et que des pr√©conisations ont √©t√© √©tablies, la tentation de r√©duire la facture imm√©diatement peut √™tre forte en menant toutes les actions d&amp;rsquo;un coup. C&amp;rsquo;est rarement une bonne chose. En menant plusieurs actions en parall√®le, il devient plus difficile de d√©terminer quelles sont celles qui ont eu l&amp;rsquo;effet escompt√©, et pire, certaines peuvent entrer en contradiction sans qu&amp;rsquo;il ne soit possible de d√©terminer comment. En it√©rant, action par action, il devient ais√© de d√©terminer celles qui ont bien fonctionn√© et donc de les r√©p√©ter dans le temps ou sur d&amp;rsquo;autres environnements.&lt;/p>
&lt;h3 id="un-processus-√†-complexit√©-croissante">Un processus √† complexit√© croissante
&lt;/h3>&lt;p>La premi√®re action (cf suite de l&amp;rsquo;article) est g√©n√©ralement de traquer les d√©penses inutiles, les g√¢chis. C&amp;rsquo;est une action relativement simple, qu&amp;rsquo;on peut faire manuellement dans un premier temps puis automatis√©e. Une fois que c&amp;rsquo;est en place, d&amp;rsquo;autres actions peuvent √™tre men√©es, forc√©ment plus compliqu√©es que les pr√©c√©dentes, et ainsi de suite. Il appara√Æt rapidement que le rapport √©conomies possibles sur investissement (temps + argent) s&amp;rsquo;amenuise avec le temps, plus on avance dans les solutions trouv√©es pour limiter les co√ªts ou √©conomiser, plus celles-ci deviennent complexes √† mettre en oeuvre. Je pense m√™me que la tendance suivie est exponentielle. L&amp;rsquo;ordre de grandeur de l&amp;rsquo;investissement n&amp;rsquo;est pas du tout le m√™me entre une automatisation de la suppression des volumes d√©tach√©s et la refonte d&amp;rsquo;une partie de l&amp;rsquo;infrastructure pour utiliser du &lt;em>Serverless&lt;/em>.&lt;/p>
&lt;h2 id="outillage">Outillage
&lt;/h2>&lt;p>Avec quoi pouvons-nous mener une analyse &lt;em>FinOps&lt;/em>?&lt;/p>
&lt;p>Il s&amp;rsquo;agit bien entendu d&amp;rsquo;une liste non exhaustive, mais c&amp;rsquo;est une demande qui m&amp;rsquo;a souvent √©t√© fa√Æte donc la voici.&lt;/p>
&lt;h2 id="les-factures">Les Factures
&lt;/h2>&lt;p>Les factures sont, bien entendu, les premi√®res pi√®ces √† √©tudier, elles sont souvent simplifi√©es et permettent d&amp;rsquo;avoir un aper√ßu global ainsi que les tendances. C&amp;rsquo;est aussi ce que re√ßoit votre service comptabilit√© (√ßa aidera pour communiquer avec eux, pour lui expliquer les possibles pics ou autres quand c&amp;rsquo;est n√©cessaire).&lt;/p>
&lt;h2 id="aws-cost-explorertrusted-advisor">AWS Cost Explorer/Trusted Advisor
&lt;/h2>&lt;p>AWS fournit 2 outils:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Cost Explorer&lt;/strong>: Cela va √™tre votre nouvel meilleur ami. L&amp;rsquo;outil s&amp;rsquo;am√©liore d&amp;rsquo;ann√©e en ann√©e et vous permet d&amp;rsquo;analyser et de mettre en graphique tout votre historique de d√©penses, de filtrer par tags, service, r√©gion, etc. C&amp;rsquo;est vraiment un indispensable et il faut vraiment apprendre √† s&amp;rsquo;en servir. La difficult√© est de comprendre ce qu&amp;rsquo;on lit, car contrairement aux factures, les d√©tails se basent sur l&amp;rsquo;API AWS et non une simplification des termes comme dans les factures re√ßues en fin de mois.&lt;/li>
&lt;li>&lt;strong>Trusted Advisor&lt;/strong>: Lorsque vous souscrivez au support de niveau &lt;strong>Business&lt;/strong>, en plus de donner de bonnes informations li√©es √† la s√©curit√© de votre plateforme, l&amp;rsquo;outil vous donne des informations sur les g√¢chis financiers pr√©sents dans le compte. La n√©cessit√© d&amp;rsquo;avoir un haut niveau de support pour que ce soit actif peut √™tre contraignant mais heureusement, les √©l√©ments donn√©s sont relativement simples √† obtenir √† la main ou via script.&lt;/li>
&lt;/ul>
&lt;h2 id="les-scripts">Les Scripts
&lt;/h2>&lt;p>Il existe une pl√©thore de scripts voire d&amp;rsquo;applications compl√®tes sur le web pour aider √† analyser ses co√ªts et trouver les axes d&amp;rsquo;am√©lioration. Vous pouvez √©galement √©crire vos propres scripts pour mettre en avant des points pr√©cis li√©s √† votre infrastructure. L&amp;rsquo;avantage de l&amp;rsquo;automatisation est bien entendu de vous faire gagner du temps mais surtout de pouvoir avoir des r√©sultats r√©guliers et donc de suivre les r√©sultats de vos modifications.&lt;/p>
&lt;p>Voici quelques exemples (les deux premiers sont de moi):&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://github.com/claranet/go-s3-describe" target="_blank" rel="noopener"
>go-s3-describe&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://github.com/claranet/aws-inventory-graph" target="_blank" rel="noopener"
>aws-inventory-graph&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://github.com/mlabouardy/komiser" target="_blank" rel="noopener"
>komiser&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Et une recherche sur Github avec quelques autres outils: &lt;a class="link" href="https://github.com/search?q=finops&amp;#43;aws&amp;amp;type=Repositories" target="_blank" rel="noopener"
>R√©sultats&lt;/a>&lt;/p>
&lt;h2 id="saas">SaaS
&lt;/h2>&lt;p>L&amp;rsquo;engouement pour le &lt;em>FinOps&lt;/em> vient forc√©ment avec son lot de services en ligne pour aider dans la t√¢che, en voici deux que j&amp;rsquo;ai test√©s (je ne ferai pas de comparatif, n&amp;rsquo;y ayant pas touch√© depuis longtemps maintenant):&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://www.cloudhealthtech.com/" target="_blank" rel="noopener"
>Cloudhealth&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://cloudcheckr.com/" target="_blank" rel="noopener"
>Cloudcheckr&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Ces outils font plus que du &lt;em>FinOps&lt;/em>, mais comme leurs co√ªts rentrent dans ce que j&amp;rsquo;appelle les co√ªts &lt;em>Indirects&lt;/em>, il faut donc les prendre en compte dans vos calculs pour estimer les √©conomies.&lt;/p>
&lt;h2 id="websites">Websites
&lt;/h2>&lt;p>Le web fourmille de documentations et d&amp;rsquo;articles comme celui-ci, il ne faudra pas h√©siter √† chercher des heures durant pour apprendre les techniques en vogue pour limiter les co√ªts ou m√™me d√©coder la documentation AWS parfois absconde.&lt;/p>
&lt;p>Voici un exemple d&amp;rsquo;outils que l&amp;rsquo;on peut trouver et utiliser fr√©quemment:&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://Instances.vantage.sh" target="_blank" rel="noopener"
>https://Instances.vantage.sh&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://calculator.aws/#/" target="_blank" rel="noopener"
>https://calculator.aws/#/&lt;/a> (calculateur officiel fourni par &lt;em>AWS&lt;/em>)&lt;/li>
&lt;li>&lt;a class="link" href="https://observablehq.com/@rustyconover/aws-ec2-spot-Instance-simulator" target="_blank" rel="noopener"
>https://observablehq.com/@rustyconover/aws-ec2-spot-Instance-simulator&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="sch√©mas">Sch√©mas
&lt;/h2>&lt;p>Le &lt;em>FinOps&lt;/em> est un travail technique, m√™me si on √©pluche bien les factures, il est int√©ressant d&amp;rsquo;avoir la vision de la plateforme en terme d&amp;rsquo;architecture. Comprendre comment les choses sont pens√©es, de l&amp;rsquo;Instance aux services manag√©s. Le nec plus ultra √©tant d&amp;rsquo;avoir √©galement les flux r√©els et pas juste un sch√©ma de principe, les flux √©tant souvent tr√®s difficiles √† cat√©goriser et encore plus √† comprendre niveau facturation.&lt;/p>
&lt;p>Voici un sch√©ma de quelques flux avec les sens pour lesquels AWS vous facture:&lt;/p>
&lt;p>&lt;img src="https://thomas.labarussias.fr/posts/finops/img/aws-flux.png"
width="1962"
height="1076"
srcset="https://thomas.labarussias.fr/posts/finops/img/aws-flux_hu_13aec99b78a5c9ad.png 480w, https://thomas.labarussias.fr/posts/finops/img/aws-flux_hu_c50d7d94b5275590.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="182"
data-flex-basis="437px"
>&lt;/p>
&lt;h2 id="la-m√©trologie">La M√©trologie
&lt;/h2>&lt;p>Tous les &lt;em>Cloud Providers&lt;/em> fournissent leurs propres solutions de m√©trologie, plus ou moins avanc√©es. Dans le cas d&amp;rsquo;AWS, la solution s&amp;rsquo;appelle &lt;em>Cloudwatch&lt;/em>. Bien que pratiques, il est n√©cessaire, pour √©valuer le bon usage des ressources, d&amp;rsquo;avoir son propre syst√®me de m√©trologie, avec une granularit√© plus fine, mais surtout plus de m√©triques.
Prenons le cas de l&amp;rsquo;utilisation CPU, qui est certes rarement un facteur limitant sur des services Web, l&amp;rsquo;utilisation de la m√©moire ou les IO √©tant plus √† suivre. Vous n&amp;rsquo;avez aucune information sur les contextes d&amp;rsquo;ex√©cution (&lt;em>user&lt;/em>, &lt;em>system&lt;/em>, &lt;em>steal&lt;/em>, &lt;em>iowait&lt;/em>, &amp;hellip;).
Dans le cas de la RAM, votre &lt;em>Cloud Provider&lt;/em> ne vous fournira pas de d√©tails sur son utilisation, difficile de juger en l&amp;rsquo;√©tat de la pertinence de sa taille pour vos besoins.&lt;/p>
&lt;h2 id="beaucoup-dactions-possibles">Beaucoup d&amp;rsquo;actions possibles
&lt;/h2>&lt;p>La liste suivante d&amp;rsquo;actions cat√©goris√©es &lt;em>FinOps&lt;/em> ne se veut absolument pas compl√®te, chaque service ayant ses sp√©cificit√©s et les mod√®les de facturation √©voluant aussi dans le temps. Encore une fois, m√™me si tr√®s orient√© &lt;em>AWS&lt;/em>, elles sont tout ou en partie transposables √† d&amp;rsquo;autres &lt;em>Cloud Providers&lt;/em>.&lt;/p>
&lt;h3 id="cat√©goriser-les-actions-√†-entreprendre">Cat√©goriser les actions √† entreprendre
&lt;/h3>&lt;p>Afin de pouvoir mieux √©valuer les pertinences des actions pr√©conis√©es mais aussi de pouvoir les prioriser, j&amp;rsquo;ai pris l&amp;rsquo;habitude de les cat√©goriser selon 3 crit√®res:&lt;/p>
&lt;ul>
&lt;li>&lt;em>Complexit√©&lt;/em>: C&amp;rsquo;est souvent un bon moyen pour aider √† estimer le temps qui sera n√©cessaire pour la mise en oeuvre.&lt;/li>
&lt;li>&lt;em>Risque&lt;/em>: Notre but, comme explicit√© dans ma d√©finition, est de ne pas d√©grader la production, mais toute action √† sa part de risque, surtout lors d&amp;rsquo;une bascule d&amp;rsquo;un morceau d&amp;rsquo;architecture √† une autre, ou bien lors de la r√©duction du type d&amp;rsquo;une Instance.&lt;/li>
&lt;li>&lt;em>Economies attendues&lt;/em>: En valeur absolue bien souvent, et √† mettre en perspective avec les deux autres crit√®res. Il peut √™tre pertinent de faire une action simple, sans risque qui fait √©conomiser $100 plut√¥t qu&amp;rsquo;une refonte compliqu√©e qui fera gagner $200 mais demandera 10JH par ailleurs (rappelez-vous, les co√ªts &lt;em>Indirects&lt;/em>).&lt;/li>
&lt;/ul>
&lt;p>Lorsque l&amp;rsquo;audit &lt;em>FinOps&lt;/em> est pour un client tiers, cela sera d&amp;rsquo;autant plus important de lui permettre d&amp;rsquo;√©valuer les actions qu&amp;rsquo;il voudra mener ou faire mener, lui seul ayant les cordons de sa bourse.&lt;/p>
&lt;h3 id="identifier-et-supprimer-les-g√¢chis">Identifier et supprimer les g√¢chis
&lt;/h3>&lt;p>La premi√®re action √† laquelle on pense, est bien √©videmment de r√©duire les g√¢chis. La flexibilit√© du &lt;em>Cloud&lt;/em> amenant souvent √† cr√©er puis laisser tra√Æner des ressources dans un coin.&lt;/p>
&lt;p>Voici une liste de quelques g√¢chis communs:&lt;/p>
&lt;ul>
&lt;li>&lt;em>Snapshots anciens&lt;/em>: Plusieurs cas de figures, soit ce sont des &lt;em>Snapshots&lt;/em> pour des &lt;em>AMI&lt;/em> obsol√®tes, soit de volumes &lt;em>EBS&lt;/em> n&amp;rsquo;existant plus. Il se peut que ce soit de vieux &lt;em>Snapshots&lt;/em> d&amp;rsquo;&lt;em>EBS&lt;/em> encore en fonctionnement, dans ce cas, comme ils sont sauvegard√©s de mani√®re incr√©mentale, leurs suppressions entra√Æneront un gain moins important sur la facture, les plus r√©cents ayant toujours besoin d&amp;rsquo;une r√©f√©rence.&lt;/li>
&lt;li>&lt;em>AMI Anciennes&lt;/em>: Sauf si cela s&amp;rsquo;av√®re vraiment n√©cessaire, il n&amp;rsquo;est pas utile de garder de vieilles &lt;em>AMI&lt;/em>, avec des syst√®mes et des paquets obsol√®tes. Leurs suppressions ne font rien gagner √† proprement parl√©, mais lib√®rent des &lt;em>Snapshots&lt;/em> qui eux peuvent ensuite √™tre supprim√©s.&lt;/li>
&lt;li>&lt;em>EIP d√©tach√©es&lt;/em>: Le gain est minime, mais si vraiment elles ne servent √† rien, autant les lib√©rer.&lt;/li>
&lt;li>&lt;em>EBS d√©tach√©s&lt;/em>: Cela vient souvent de la suppression d&amp;rsquo;&lt;em>Instances&lt;/em> sans suppression des volumes qui les utilisaient. Si en plus il y avait de l&amp;rsquo;&lt;em>AutoScaling&lt;/em> d&amp;rsquo;actif, les volumes peuvent vite monter.&lt;/li>
&lt;li>&lt;em>EBS attach√©s mais sans IO&lt;/em>: Le coup classique du volume mont√© sur &lt;code>/logs&lt;/code> mais o√π aucune application n&amp;rsquo;√©crit dedans.&lt;/li>
&lt;li>&lt;em>ELB/ALB/NLB sans Instance ou sans requ√™te&lt;/em>: Il arrivent que des &lt;code>xLB&lt;/code> ne pointent vers rien, ou bien que les &lt;em>Instances&lt;/em> derri√®res soient &lt;em>Unhealthy&lt;/em> depuis tr√®s longtemps, sans aucun impact par ailleurs.&lt;/li>
&lt;li>&lt;em>EC2/RDS dans des anciens types&lt;/em>: A chaque nouvelle famille sortie par &lt;em>AWS&lt;/em>, les prix sont plus faibles, pour parfois de meilleures performances ou options.&lt;/li>
&lt;li>&lt;em>EC2 stopp√©es depuis longtemps&lt;/em>: Le &lt;em>compute&lt;/em> n&amp;rsquo;est pas pay√© dans ce cas, seul le stockage, cela peut √™tre l√©gitime ou non. A vous de voir.&lt;/li>
&lt;li>&lt;em>Buckets S3 avec des objets de type Reduced Redundancy Storage Class&lt;/em>: AWS a d√©pr√©ci√© ce type d&amp;rsquo;objet, en le rendant l√©g√®rement plus ch√®re d&amp;rsquo;un milli√®me que le type &lt;em>Standard&lt;/em>, sur des Po voire To, cela vite (histoire v√©cue avec une plateforme de streaming de musique)&lt;/li>
&lt;li>&lt;em>Buckets S3 Buckets qui sont Publics mais pas derri√®re une distribution CloudFront&lt;/em>: Rien que le fait de sortir sur Internet √† travers une distribution &lt;em>Cloudfront&lt;/em> r√©duit les co√ªts de bande passante, cache activ√© ou non. Ceci est valable dans tous les cas, devant &lt;code>xLB&lt;/code> ou &lt;code>EC2&lt;/code>.&lt;/li>
&lt;li>&lt;em>RDS sans connexion depuis longtemps&lt;/em>: Si la base ne sert que de temps en temps, il est toujours possible de l&amp;rsquo;√©teindre (pour 7j maximum, ensuite il faudra √©teindre de nouveau).&lt;/li>
&lt;li>&lt;em>RDS utilisant du PIOPS inutile&lt;/em>: Pour chaque GB de &lt;em>GP2/3&lt;/em>, &lt;em>AWS&lt;/em> assure un plancher de 3 IOPS, ce qui implique qu&amp;rsquo;avec 350GB, vous avez plus (1050 IOPS) que les 1000 IOPS demand√©s √† √™tre pay√©s en minimum pour le stockage &lt;em>PIOPS&lt;/em>, et ce pour beaucoup moins cher.&lt;/li>
&lt;/ul>
&lt;p>Pour vous aider √† identifier ces √©l√©ments, l&amp;rsquo;&lt;em>API&lt;/em> et les m√©triques en votre possession seront tr√®s utiles.&lt;/p>
&lt;h3 id="utiliser-correctement-les-ressources">Utiliser correctement les ressources
&lt;/h3>&lt;h4 id="les-ressources-manag√©es">Les ressources manag√©es
&lt;/h4>&lt;p>Avec l&amp;rsquo;av√®nement du &lt;em>Cloud&lt;/em>, sa souplesse et sa rapidit√© pour obtenir des ressources, on en vient presque √† oublier les r√©flexes de nos pr√©d√©cesseurs, contraints √† tirer jusqu&amp;rsquo;√† la derni√®re goutte de s√®ve des machines achet√©es pour plusieurs ann√©es.
Je crois fermement, qu&amp;rsquo;avant d&amp;rsquo;entamer des changements de type, surtout lors de &lt;em>Scale Up&lt;/em> (augmentation du type), il faut travailler au niveau de l&amp;rsquo;&lt;em>OS&lt;/em> et des applications pour obtenir le maximum. Tout r√©soudre par de l&amp;rsquo;infra n&amp;rsquo;a jamais √©t√© pertinent (le fameux plus de RAM, toujours plus de RAM, au lieu de traiter la fuite m√©moire).&lt;/p>
&lt;h4 id="los-et-les-applications">L&amp;rsquo;OS et les Applications
&lt;/h4>&lt;p>Dans le cas des ressources manag√©es, surtout &lt;em>RDS&lt;/em>, de tr√®s nombreux r√©glages sont √† disposition pour param√©trer les moteurs (taille des &lt;em>buffers&lt;/em>, allocation de tables temporaires, nombre max de connexions, etc). Les ajuster au r√©el besoin m√©tier peut parfois changer du tout au tout les performances.&lt;/p>
&lt;p>Pour les EC2, c&amp;rsquo;est encore plus vrai, car on peut jouer sur bien plus de r√©glages comme:&lt;/p>
&lt;ul>
&lt;li>les &lt;em>param√®tres sysctl&lt;/em>: Tous les &lt;em>OS Unix-Like&lt;/em> permettent de r√©gler des param√®tres du &lt;em>kernel&lt;/em>, dont beaucoup de limites. En ajustant ces valeurs, on peut souvent repousser les capacit√©s utilisables.&lt;/li>
&lt;li>les &lt;em>configurations des applications&lt;/em>: La majorit√© des applications, surtout dans le monde du &lt;em>Web OpenSource&lt;/em>, permettent d&amp;rsquo;√™tre configur√©es jusqu&amp;rsquo;au plus petit d√©tails pour assurer leurs charges (&lt;em>worker_processes&lt;/em> ou &lt;em>keepalives&lt;/em> pour &lt;em>Nginx&lt;/em> par exemple).&lt;/li>
&lt;/ul>
&lt;h4 id="compiler-ses-binaires">Compiler ses binaires
&lt;/h4>&lt;p>Une autre option, bien moins r√©pandue, car plus difficile √† mettre en oeuvre, est le fait d&amp;rsquo;utiliser des binaires compil√©s pour l&amp;rsquo;architecture &lt;em>CPU&lt;/em> de l&amp;rsquo;&lt;em>EC2&lt;/em> utilis√©e. Cela peut para√Ætre farfelu, surtout que cela apporte une grande complexit√© et sort totalement du cadre des gestionnaires de paquets si pratiques. Mais apr√®s tout, utiliser des binaires compil√©s en dehors de toute arborescence, c&amp;rsquo;est une chose tr√®s r√©pandue, et cela s&amp;rsquo;appelle un &lt;em>Container&lt;/em> üòâ. AWS fournit pour chaque type d&amp;rsquo;&lt;em>Instance&lt;/em> le mod√®le de &lt;em>CPU&lt;/em> associ√©, √† votre charge de trouver les bons &lt;em>flags&lt;/em> √† utiliser pour la compilation, et de penser √† les modifier √† chaque changement de type (par un exemple, un rendu &lt;em>Blender&lt;/em> via le &lt;em>CPU&lt;/em> peut gagner jusqu&amp;rsquo;√† 30% de temps [du v√©cu], imaginez pour la capacit√© de traitements de requ√™tes par un &lt;em>Apache&lt;/em> ou &lt;em>Nginx/PHP-FPM&lt;/em>).&lt;/p>
&lt;h3 id="utiliser-les-services-manag√©s">Utiliser les services manag√©s
&lt;/h3>&lt;p>Utiliser des services manag√©s a un co√ªt, c&amp;rsquo;est ind√©niable, mais ils sont √† relativiser et √† mettre en perspective avec les co√ªts &lt;em>Indirects&lt;/em>. Entre un &lt;em>PostgreSQL&lt;/em> manag√© et un &lt;em>PostgreSQL&lt;/em> install√© √† la main sur un serveur lou√©, il se peut que la solution du &lt;em>Cloud Provider&lt;/em> soit plus ch√®re, mais si vous rajoutez dans votre solution maison les co√ªts financiers et humains pour la gestion des backups, des possibles restaurations, de la haute disponibilit√©, etc, sans avoir en plus forc√©ment la capacit√© de changer la taille de la machine ou agrandir son stockage, la balance ne penche plus du m√™me c√¥t√©. Encore une fois, s&amp;rsquo;arr√™ter uniquement aux co√ªts mat√©riels (qui se rattachent aux co√ªts &lt;em>Directs&lt;/em>) et ne pas prendre l&amp;rsquo;ensemble du p√©rim√®tre financier, peut s&amp;rsquo;av√©rer contre-productif.&lt;/p>
&lt;h3 id="mettre-en-place-des-outils-des-proc√©dures-des-formations">Mettre en place des outils, des proc√©dures, des formations
&lt;/h3>&lt;p>Je conseille g√©n√©ralement de commencer par tout faire manuellement, que ce soit l&amp;rsquo;analyse des co√ªts dans le &lt;em>Cost Explorer&lt;/em>, la recherche des g√¢chis ou l&amp;rsquo;estimation des √©conomies possibles. Cela dans le but de vraiment comprendre comment les choses fonctionnent et de pouvoir rep√©rer d&amp;rsquo;un coup d&amp;rsquo;oeil des axes d&amp;rsquo;am√©liorations une fois que l&amp;rsquo;habitude est fa√Æte.
Une fois rod√©, il est temps de mettre en place des proc√©dures, et si possible des outils automatis√©s pour limiter les d√©rives dans le temps. L&amp;rsquo;automatisation des proc√©dures de nettoyage et d&amp;rsquo;extinction des environnements en dehors des heures ouvr√©es sont des grands classiques, on trouve de nombreux exemples sur le net.
Comme √©voqu√© plus haut, c&amp;rsquo;est √† ce niveau que les alertes de &lt;em>Budget&lt;/em> peuvent aussi apporter leurs aides, m√™me si elles peuvent souvent s&amp;rsquo;av√©rer trop rigides (une p√©riode de soldes peut exploser les compteurs par rapport au mois d&amp;rsquo;avant, sans que cela soit inqui√©tant, bien au contraire).
Un volet √† ne pas n√©gliger √† cette √©tape (√† toutes en fait), est de former les √©quipes (chez soi ou chez son client), √† ce qu&amp;rsquo;est le &lt;em>FinOps&lt;/em>, ce qu&amp;rsquo;il apporte et sur les proc√©dures en cours dans l&amp;rsquo;entreprise qui font partie de son processus.&lt;/p>
&lt;h3 id="architecturer-pour-r√©duire-les-co√ªts">Architecturer pour r√©duire les co√ªts
&lt;/h3>&lt;p>C&amp;rsquo;est la m√©thode la plus complexe, mais souvent la plus efficace et gratifiante, la refonte. Les &lt;em>Cloud Providers&lt;/em> sortent en permanence de nouvelles fonctionnalit√©s et nouveaux services, ce qui est impossible aujourd&amp;rsquo;hui ne le sera possiblement plus dans 1 ou 2 ans. Int√©grer le &lt;em>FinOps&lt;/em> lors de la conception d&amp;rsquo;une plateforme est important pour √™tre efficient, mais cela l&amp;rsquo;est encore plus lors des refontes, qui peuvent souvent √™tre dict√©es pour des raisons de rationalisation et/ou d&amp;rsquo;√©conomies. Cela est d&amp;rsquo;autant plus pertinent que vous avez alors une vraie exp√©rience du comportement de votre plateforme, de ses besoins et contraintes.&lt;/p>
&lt;p>On peut envisager dans le cas d&amp;rsquo;une refonte de:&lt;/p>
&lt;ul>
&lt;li>migrer certaines fonctions dans &lt;em>Lambda&lt;/em>&lt;/li>
&lt;li>utiliser &lt;em>DynamoDB&lt;/em> en base &lt;em>NoSQL&lt;/em>&lt;/li>
&lt;li>utiliser des &lt;em>ALB&lt;/em> devant les &lt;em>Lambda&lt;/em> et non des &lt;em>API Gateway&lt;/em>&lt;/li>
&lt;/ul>
&lt;p>Il faut garder √† l&amp;rsquo;esprit encore une fois, que toutes les actions ont des co√ªts &lt;em>Indirects&lt;/em> (JH pour migrer le code d&amp;rsquo;une solution technique √† une autre, formations, etc), et peuvent vous &amp;ldquo;verrouiller&amp;rdquo; chez un &lt;em>Cloud Provider&lt;/em>, on touche l√†, √† la politique de l&amp;rsquo;entreprise.&lt;/p>
&lt;h3 id="politiqes-de-scale-inout">Politiqes de Scale In/Out
&lt;/h3>&lt;p>La capacit√© d&amp;rsquo;adapter la flotte de machines √† la charge est une fonctionnalit√© de base, c&amp;rsquo;est presque la raison premi√®re de l&amp;rsquo;existence du &lt;em>Cloud&lt;/em>. Avec le temps, que ce soit en natif ou via des fonctions externes, on peut piloter les groupes d&amp;rsquo;&lt;em>AutoScaling&lt;/em> pour faire beaucoup de choses comme:&lt;/p>
&lt;ul>
&lt;li>Retirer tout ou partie des machines en dehors des heures ouvr√©es&lt;/li>
&lt;li>Changer la taille des &lt;em>Instances&lt;/em> en fonction des p√©riodes&lt;/li>
&lt;li>&lt;em>Scale In/Out&lt;/em> (ajouter/retirer) en fonction de m√©triques m√©tiers et non juste le &lt;em>CPU&lt;/em> (qui est rarement une m√©trique pertinente, je le rappelle)&lt;/li>
&lt;/ul>
&lt;h3 id="r√©servations--saving-plans">R√©servations / Saving Plans
&lt;/h3>&lt;p>Si vous √™tes pr√™t √† vous engager sur du long terme (1 ou 3 ans), r√©server des ressources est le moyen le plus direct d&amp;rsquo;obtenir au moins 30% d&amp;rsquo;√©conomie (avec versement d&amp;rsquo;un account ou non) sur des services tels que:&lt;/p>
&lt;ul>
&lt;li>&lt;em>EC2&lt;/em>&lt;/li>
&lt;li>&lt;em>RDS&lt;/em>&lt;/li>
&lt;li>&lt;em>Elasticache&lt;/em>&lt;/li>
&lt;li>&lt;em>DynamoDB&lt;/em>&lt;/li>
&lt;/ul>
&lt;p>Les cas de &lt;em>DynamoDB&lt;/em> et &lt;em>Elasticache&lt;/em> sont un peu particulier, le premier demandant de r√©server des capacit√©s en &lt;em>Read/Write&lt;/em> et non des ressources &amp;ldquo;mat√©rielles&amp;rdquo; et le second imposant un acompte dans tous les cas.&lt;/p>
&lt;p>Pour rappel, les r√©servations fonctionnent avec des unit√©s de temps, il ne s&amp;rsquo;agit pas de machines avec une √©tiquette √† son nom dans le datacenter &lt;em>AWS&lt;/em>.&lt;/p>
&lt;p>Prenons un exemple pour expliciter les choses.&lt;/p>
&lt;p>Imaginons que vous r√©serviez pour 1 an, pour de l&amp;rsquo;&lt;em>EC2&lt;/em>, 1 &lt;em>&amp;ldquo;Instance&amp;rdquo;&lt;/em> &lt;code>m5.xlarge&lt;/code>. Vous obtenez donc, 4 unit√©s (cf ce &lt;a class="link" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/apply_ri.html" target="_blank" rel="noopener"
>tableau&lt;/a>) par mois dans la famille &lt;code>m5&lt;/code>. En prenant qu&amp;rsquo;un mois fait en moyenne 732h, vous aurez donc le droit au prix r√©duit pour:&lt;/p>
&lt;ul>
&lt;li>732h de &lt;code>m5.xlarge&lt;/code>&lt;/li>
&lt;li>1464h de &lt;code>m5.large&lt;/code> (soit 2 Instances)&lt;/li>
&lt;li>366h de &lt;code>m5.2xlarge&lt;/code> (soit 1 Instance allum√©e la moiti√© du mois)&lt;/li>
&lt;/ul>
&lt;p>Les unit√©s sont circonscrites √† une famille, c&amp;rsquo;est exactement le m√™me cas pour les &lt;em>Saving Plans&lt;/em> de type &lt;em>EC2 Instance&lt;/em> (les √©conomies sont √† la virgule pr√®s les m√™mes que pour les R√©servations). Si vous voulez ne pas √™tre contraint, et ne raisonner qu&amp;rsquo;en termes d&amp;rsquo;unit√©s de calcul et non de &amp;ldquo;famille&amp;rdquo;, les &lt;em>Saving Plans&lt;/em> de type &lt;em>Compute&lt;/em>, sont la nouvelle m√©thode pour proc√©der √† des r√©servations chez &lt;em>AWS&lt;/em>, peu importe la famille ou le type. Les r√©ductions sur le &lt;em>Compute&lt;/em> s&amp;rsquo;appliquant peu importe le type, cela vous permet de changer de famille quand vous le souhaitez. Cela vient cependant avec une √©conomie moindre.&lt;/p>
&lt;h3 id="spot-instances">Spot Instances
&lt;/h3>&lt;p>&lt;em>AWS&lt;/em> met √† disposition son stock d&amp;rsquo;invendus (en quelque sorte) √† prix cass√© (jusqu&amp;rsquo;√† -70%), ce qu&amp;rsquo;ils appellent des &lt;em>Spot Instances&lt;/em>. Le principe est simple, vous d√©finissez un prix maximal pour lequel vous √™tes pr√™t √† payer, et tant que le prix courant est inf√©rieur et qu&amp;rsquo;&lt;em>AWS&lt;/em> a du stock, vous √™tes susceptible d&amp;rsquo;avoir votre &lt;em>Instance&lt;/em>. Si un des crit√®res n&amp;rsquo;est plus respect√©, &lt;em>AWS&lt;/em> vous pr√©vient 2min avant de vous retirer l&amp;rsquo;&lt;em>Instance&lt;/em>. Pour mitiger les risques, vous avez la possibilit√© de vous faire des flottes, c&amp;rsquo;est-√†-dire des groupes d&amp;rsquo;&lt;em>Instances&lt;/em> de diff√©rents types.&lt;/p>
&lt;p>C&amp;rsquo;est un moyen extr√™mement puissant pour faire des √©conomies, √† condition que l&amp;rsquo;usage que vous en fa√Ætes tol√®re de perdre des noeuds, c&amp;rsquo;est donc tr√®s souvent utilis√© pour faire des tests au sein d&amp;rsquo;une &lt;em>CI&lt;/em>, par exemple.&lt;/p>
&lt;p>Un autre aspect √† prendre en compte et qui permet de limiter encore plus les risques, c&amp;rsquo;est de mixer des &lt;em>Instances&lt;/em> &lt;em>On-Demand&lt;/em> (pay√©es au prix public annonc√©) et des &lt;em>Instances&lt;/em> &lt;em>Spot&lt;/em>. C&amp;rsquo;est d√©sormais possible avec les &lt;em>Launch Templates&lt;/em> qui d√©finissent comment doivent √™tre les &lt;em>Instances&lt;/em> d&amp;rsquo;un groupe d&amp;rsquo;&lt;em>Auto-Scaling&lt;/em>. Vous d√©finissez le nombre d&amp;rsquo;&lt;em>Instances&lt;/em> &lt;em>On-Demand&lt;/em> qui constitueront votre base, puis le pourcentage d&amp;rsquo;&lt;em>On-Demand&lt;/em> au dessus cette base par rapport aux &lt;em>Instances&lt;/em> &lt;em>Spot&lt;/em>. Si votre base &lt;em>On-Demand&lt;/em> correspond √† vos r√©servations, l&amp;rsquo;√©conomie est encore plus importante avec un risque contr√¥l√©.&lt;/p>
&lt;h3 id="organisation-des-comptes">Organisation des comptes
&lt;/h3>&lt;p>La bonne pratique est d&amp;rsquo;isoler les environnements (prod, staging, etc) dans des comptes &lt;em>AWS&lt;/em> diff√©rents. Isoler les comptes les uns des autres permet, entre autres:&lt;/p>
&lt;ul>
&lt;li>d&amp;rsquo;assurer l&amp;rsquo;√©tanch√©it√© pour la s√©curit√©&lt;/li>
&lt;li>de bien s√©parer les co√ªts, ce qui facilite les analyses (un flux sortant est un flux sortant, &lt;em>AWS&lt;/em> ne vous dira pas de quelle &lt;em>VPC&lt;/em> pr√©cis√©ment il vient, difficile de refacturer entre &lt;em>cost centers&lt;/em> dans ce cas)&lt;/li>
&lt;/ul>
&lt;p>A c√¥t√© de cela il est tr√®s int√©ressant de regrouper tous ces comptes au sein d&amp;rsquo;une seule organisation, avec un compte payeur identifi√© (appel√© compte consolidant) et ne poss√©dant aucune ressource (pour simplifier les analyses, de cette mani√®re il n&amp;rsquo;appara√Ætra pas 2 fois, en tant que compte et compte consolidant).&lt;/p>
&lt;p>Il y a plusieurs avantages √† faire cela, le compte payeur agr√©geant la totalit√© de la facture:&lt;/p>
&lt;ul>
&lt;li>les r√©servations sont remont√©es au niveau du compte consolidant (sauf param√©trage volontaire), ce qui implique que les unit√©s non utilis√©es d&amp;rsquo;un c√¥t√© peuvent l&amp;rsquo;√™tre de l&amp;rsquo;autre, vous ne payez pas pour rien&lt;/li>
&lt;li>vous b√©n√©ficiez des tarifs sur les volumes (au sens de quantit√©), ce qu&amp;rsquo;on appelle les &lt;em>Blended Costs&lt;/em>.&lt;/li>
&lt;li>&lt;em>AWS&lt;/em> fournit une facture r√©capitulative de l&amp;rsquo;ensemble des frais, ce qui fera plaisir au service comptable qui n&amp;rsquo;aura pas √† g√©rer N pdf.&lt;/li>
&lt;/ul>
&lt;p>Les &lt;em>Blended Costs&lt;/em> sont une mani√®re d&amp;rsquo;agr√©ger tous les volumes de certains services et de b√©n√©ficier ainsi des tranches de prix inf√©rieures.&lt;/p>
&lt;p>Prenons comme exemple &lt;em>S3&lt;/em> pour expliciter la chose.&lt;/p>
&lt;blockquote>
&lt;p>Imaginons deux comptes li√©s A et B √† un compte consolidant Z.
Les usages S3 sont respectivement:&lt;/p>
&lt;ul>
&lt;li>50To en eu-west-3 pour le compte A&lt;/li>
&lt;li>30To en eu-west-3 pour le compte B&lt;/li>
&lt;/ul>
&lt;p>Si les comptes √©taient factur√©s s√©par√©ment, il devraient:&lt;/p>
&lt;ul>
&lt;li>compte A: &lt;code>40To x 0,024$/GB = $960&lt;/code>&lt;/li>
&lt;li>compte B: &lt;code>30To x 0,024$/GB = $720&lt;/code>&lt;/li>
&lt;li>total: &lt;code>$1680&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>Avec les Blended Costs, le compte Z consolidant le tout paiera en fait:&lt;/p>
&lt;ul>
&lt;li>&lt;code>50To x 0,024$/GB + 20To x 0,023$/GB = $1620&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>Le principe sous-jacent √©tant que pour S3, en eu-west-3, les 50 premiers To valent &lt;code>0,024$/GB&lt;/code> et &lt;code>0,023$/GB&lt;/code> au del√†.&lt;/p>
&lt;p>On a donc une √©conomie de $60, sans aucune action autre qu&amp;rsquo;avoir li√© les comptes A et B √† Z.&lt;/p>&lt;/blockquote>
&lt;p>(voir &lt;a class="link" href="https://aws.amazon.com/fr/s3/pricing/" target="_blank" rel="noopener"
>ICI&lt;/a> pour les tarifs de &lt;em>S3&lt;/em>)&lt;/p>
&lt;h2 id="tags">Tags
&lt;/h2>&lt;p>On touche au nerf de la guerre, les &lt;em>Tags&lt;/em>. Il est essentiel pour comprendre les co√ªts, voire de les anticiper, de cat√©goriser au maximum les choses, et cela passe par le tagging des ressources qui le peuvent (on ne peut pas tagger les flux r√©seau, par exemple).&lt;/p>
&lt;p>Voici quelques tags utiles:&lt;/p>
&lt;ul>
&lt;li>&lt;code>environnement&lt;/code>&lt;/li>
&lt;li>&lt;code>project&lt;/code>&lt;/li>
&lt;li>&lt;code>businessUnit&lt;/code>&lt;/li>
&lt;li>&lt;code>costCenter&lt;/code>&lt;/li>
&lt;li>&lt;code>scope&lt;/code>&lt;/li>
&lt;li>&lt;code>team&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>Il y a un point tr√®s important √† savoir, les tags sont sensibles √† la casse au niveau des cl√©s et des valeurs, il faut donc √™tre vigilant pour ne pas avoir des &lt;code>prod&lt;/code>, &lt;code>Prod&lt;/code>, &lt;code>production&lt;/code>, etc, qui repr√©sentent la m√™me valeur mais cr√©ent du bruit, voire peuvent cacher certaines ressources de vos rapports.&lt;/p>
&lt;p>Pour vous aider dans votre rattrapage, dans le cas o√π vous avez des ressources cr√©√©es √† la main, &lt;em>AWS&lt;/em> fournit un outil au final assez m√©connu, le &lt;a class="link" href="https://docs.aws.amazon.com/ARG/latest/userguide/tag-editor.html" target="_blank" rel="noopener"
>&lt;em>Tag Editor&lt;/em>&lt;/a>.&lt;/p>
&lt;h2 id="conclusion">Conclusion
&lt;/h2>&lt;p>Cet article n&amp;rsquo;est finalement qu&amp;rsquo;une √©bauche de tout ce qu&amp;rsquo;on peut faire sans vraiment rentrer dans les d√©tails de comment on le fait. Il ne repr√©sente qu&amp;rsquo;une synth√®se de mes r√©flexions, dont les conclusions sont s√ªrement discutables (et peut-√™tre obsol√®tes maintenant, le monde du &lt;em>Cloud&lt;/em> bougeant tellement vite). Vous avez s√ªrement remarqu√© qu&amp;rsquo;il y a un grand absent dans cet article, quid du &lt;em>FinOps&lt;/em> quand on utilise &lt;em>Kubernetes&lt;/em>? A l&amp;rsquo;√©poque o√π je faisais encore des audits &lt;em>FinOps&lt;/em>, bien qu&amp;rsquo;utilisant &lt;em>K8S&lt;/em> en production, je n&amp;rsquo;avais jamais eu √† creuser s√©rieusement la question. Je pense cependant que les principes g√©n√©raux que j&amp;rsquo;ai mentionn√©s peuvent s&amp;rsquo;appliquer en partie, dans le cas d&amp;rsquo;un environnement avec des ressources mutualis√©es comme l&amp;rsquo;est &lt;em>Kubernetes&lt;/em>.&lt;/p>
&lt;p>Merci d&amp;rsquo;avoir lu jusqu&amp;rsquo;au bout ce long article, et j&amp;rsquo;esp√®re qu&amp;rsquo;il aura √©t√© utile √† quelqu&amp;rsquo;un, il m&amp;rsquo;a au moins permis de sortir de ma t√™te quelque chose qui y tra√Ænait depuis longtemps.&lt;/p>
&lt;p>&lt;em>Enjoy&lt;/em>&lt;/p></description></item><item><title>Falco: D√©tection et r√©action aux menaces dans Kubernetes</title><link>https://thomas.labarussias.fr/posts/cncf-meetup-paris-mars-2021/</link><pubDate>Tue, 06 Apr 2021 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/posts/cncf-meetup-paris-mars-2021/</guid><description>&lt;p>J&amp;rsquo;ai enregistr√© il y a quelques jours une pr√©sentation traitant de &lt;code>falco&lt;/code> et &lt;code>falcosidekick&lt;/code> pour un Meetup CNCF Paris. J&amp;rsquo;y aborde ce que sont &lt;code>falco&lt;/code> et &lt;code>falcosidekick&lt;/code> et je montre comment on peut se servir des &lt;em>outputs&lt;/em> de &lt;code>falcosidekick&lt;/code> pour r√©agir en cas de d√©tection de comportements suspects.&lt;/p>
&lt;div class="video-wrapper">
&lt;iframe loading="lazy"
src="https://www.youtube.com/embed/UCXyHRhPbdg?start=2138"
allowfullscreen
title="YouTube Video"
>
&lt;/iframe>
&lt;/div>
&lt;p>&lt;em>Enjoy&lt;/em>&lt;/p></description></item><item><title>Monitorer son application Go en local</title><link>https://thomas.labarussias.fr/posts/monitorer-golang-app-local/</link><pubDate>Sat, 27 Jun 2020 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/posts/monitorer-golang-app-local/</guid><description>&lt;p>R√©cemment, apr√®s plusieurs jours en production, nous avons d√©tect√© au boulot que notre pod &lt;a class="link" href="https://github.com/Issif/cercat" target="_blank" rel="noopener"
>Cercat&lt;/a> semblait avoir une &lt;em>memory leak&lt;/em>.&lt;/p>
&lt;p>Rien de complexe dans notre cas (ouf), cela a facilement √©t√© r√©gl√© √† coup de &lt;em>profiles Go&lt;/em> mais une question s&amp;rsquo;est pos√©e : &lt;em>&amp;ldquo;Aurais-je pu le d√©tecter avant d&amp;rsquo;envoyer en prod en sachant que l&amp;rsquo;√©volution de la consommation m√©moire √©tait relativement lente?&amp;rdquo;&lt;/em>&lt;/p>
&lt;p>&lt;img src="https://thomas.labarussias.fr/posts/monitorer-golang-app-local/img/cercat-memory-leak.png"
width="2824"
height="810"
srcset="https://thomas.labarussias.fr/posts/monitorer-golang-app-local/img/cercat-memory-leak_hu_27365a04d19f746e.png 480w, https://thomas.labarussias.fr/posts/monitorer-golang-app-local/img/cercat-memory-leak_hu_9c1aad5f94aeca9a.png 1024w"
loading="lazy"
alt="cercat memory leak"
class="gallery-image"
data-flex-grow="348"
data-flex-basis="836px"
>&lt;/p>
&lt;p>Je me suis donc mis en t√™te d&amp;rsquo;avoir une solution cl√© en main pour &lt;em>monitorer&lt;/em> en local une application &lt;em>Go&lt;/em> lors de son d√©veloppement.&lt;/p>
&lt;p>L&amp;rsquo;id√©e, tr√®s simple au final, est d&amp;rsquo;utiliser une instance de &lt;a class="link" href="https://github.com/netdata/netdata" target="_blank" rel="noopener"
>Netdata&lt;/a> dans un &lt;em>Docker&lt;/em> qui appelle l&amp;rsquo;endpoint &lt;em>expvar&lt;/em> de mon application &lt;em>Go&lt;/em>.&lt;/p>
&lt;p>Micro tuto pour comprendre le principe :&lt;/p>
&lt;ol>
&lt;li>
&lt;p>Pr√©parer notre application&lt;/p>
&lt;p>Un micro code pour l&amp;rsquo;exemple :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;expvar&amp;#34;&lt;/span> &lt;span class="c1">// package pour exposer les m√©triques Go par d√©faut et notre m√©trique custom&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;math/rand&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;net/http&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;time&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fake&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">expvar&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewFloat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;custom.fake&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// une m√©trique custom compl√®tement fausse &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ListenAndServe&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;:1111&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// on d√©marre un serveur http sur le port 1111&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">// une boucle qui met √† jour al√©atoirement notre m√©trique custom&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fake&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Set&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="nx">rand&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Float64&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Duration&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">rand&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Intn&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Second&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Le code est comment√© pour comprendre √† quoi sert chaque ligne.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>On pr√©pare la configuration de &lt;em>Netdata&lt;/em>&lt;/p>
&lt;p>&lt;code>go_expvar.conf&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;#39;golang-app&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name &lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;golang-app&amp;#39;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># le nom de notre app Go dans Netdata&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">url &lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;http://golang-app:1111/debug/vars&amp;#39;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># le port est √† adapter en fonction de l&amp;#39;application&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">collect_memstats&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># on active la collecte des m√©triques m√©moires&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">extra_charts&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># la collecte de notre m√©trique custom&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">id&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;custom&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">options&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">fake&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">title&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;custom&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">units&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">no&lt;/span>-&lt;span class="l">unit&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">family&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">custom&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">context&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">expvar.custom.fake&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">chart_type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">line&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">lines&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- {&lt;span class="nt">expvar_key: &amp;#39;custom.fake&amp;#39;, expvar_type: float, id&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">custom_fake}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>python.d.conf&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">go_expvar&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">yes&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># active le monitoring des applications Go&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>On d√©marre le tout via &lt;em>docker-compose&lt;/em>&lt;/p>
&lt;p>&lt;code>docker-compose.yaml&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nn">---&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;3&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">services&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">netdata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">netdata/netdata:latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">container_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">netdata&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;19999:19999&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;${PWD}/python.d.conf:/etc/netdata/python.d.conf:ro&amp;#34;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># pour activer le monitoring des applications GO&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;${PWD}/go_expvar.conf:/etc/netdata/python.d/go_expvar.conf:ro&amp;#34;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># pour configurer la collecte des m√©triques des applications Go&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;/etc/passwd:/host/etc/passwd:ro&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;/etc/group:/host/etc/group:ro&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;/proc:/host/proc:ro&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;/sys:/host/sys:ro&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;/var/run/docker.sock:/var/run/docker.sock:ro&amp;#34;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># pour moniter le Docker Go&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">cap_add&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">SYS_PTRACE&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">security_opt&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">apparmor:unconfined&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">golang-app&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">golang:alpine&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">container_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">golang-app&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;1111:1111&amp;#34;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># le port d&amp;#39;√©coute de notre application, √† adapter&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;${PWD}:/app&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">working_dir&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/app&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">go run main.go &lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># la commande pour lancer l&amp;#39;application, √† adapter&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Le plus important est d&amp;rsquo;adapter le port d&amp;rsquo;√©coute et la commande de d√©marrage en fonction de votre application.&lt;/p>
&lt;p>On d√©marre tout :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">docker-compose -f docker-compose.yaml up -d
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>On v√©rifie que tout est bien d√©marr√© :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ docker ps
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">5f9a07fa2e1f netdata/netdata:latest &lt;span class="s2">&amp;#34;/usr/sbin/run.sh&amp;#34;&lt;/span> About a minute ago Up About a minute &lt;span class="o">(&lt;/span>healthy&lt;span class="o">)&lt;/span> 0.0.0.0:19999-&amp;gt;19999/tcp netdata
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">4e9d30d12bec golang:alpine &lt;span class="s2">&amp;#34;go run main.go&amp;#34;&lt;/span> &lt;span class="m">5&lt;/span> days ago Up About a minute 0.0.0.0:1111-&amp;gt;1111/tcp golang-app
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>L&amp;rsquo;instance &lt;em>Netdata&lt;/em> est accessible via &lt;a class="link" href="http://localhost:19999" target="_blank" rel="noopener"
>http://localhost:19999&lt;/a>.&lt;/p>
&lt;p>Apr√®s quelques secondes on obtient nos m√©triques.&lt;/p>
&lt;p>Les m√©triques du container de notre application :&lt;/p>
&lt;p>&lt;img src="https://thomas.labarussias.fr/posts/monitorer-golang-app-local/img/netdata_golang_1.png"
width="1905"
height="955"
srcset="https://thomas.labarussias.fr/posts/monitorer-golang-app-local/img/netdata_golang_1_hu_fa1decc4d9877a2d.png 480w, https://thomas.labarussias.fr/posts/monitorer-golang-app-local/img/netdata_golang_1_hu_1a5f983d30a84422.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="199"
data-flex-basis="478px"
>&lt;/p>
&lt;p>Les m√©triques &lt;em>expvar&lt;/em> de notre application :&lt;/p>
&lt;p>&lt;img src="https://thomas.labarussias.fr/posts/monitorer-golang-app-local/img/netdata_golang_2.png"
width="1905"
height="955"
srcset="https://thomas.labarussias.fr/posts/monitorer-golang-app-local/img/netdata_golang_2_hu_10d2d6280e24b459.png 480w, https://thomas.labarussias.fr/posts/monitorer-golang-app-local/img/netdata_golang_2_hu_303e4769fa03052e.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="199"
data-flex-basis="478px"
>&lt;/p>
&lt;p>Notre m√©trique custom :&lt;/p>
&lt;p>&lt;img src="https://thomas.labarussias.fr/posts/monitorer-golang-app-local/img/netdata_golang_3.png"
width="1633"
height="271"
srcset="https://thomas.labarussias.fr/posts/monitorer-golang-app-local/img/netdata_golang_3_hu_a78367bdbcab9fb7.png 480w, https://thomas.labarussias.fr/posts/monitorer-golang-app-local/img/netdata_golang_3_hu_2023c332bd113883.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="602"
data-flex-basis="1446px"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Mettre √† jour notre application&lt;/p>
&lt;p>C&amp;rsquo;est tr√®s simple, il suffit de red√©marrer le container &lt;em>Go&lt;/em> :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ docker restart 4e9d30d12bec
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol>
&lt;p>&lt;em>Enjoy&lt;/em>&lt;/p></description></item><item><title>Cercat</title><link>https://thomas.labarussias.fr/posts/cercat/</link><pubDate>Fri, 17 Apr 2020 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/posts/cercat/</guid><description>&lt;p>En cette p√©riode de confinement, les &lt;em>phishers&lt;/em> s&amp;rsquo;en donnent √† coeur joie. La question qui se pose alors est : &lt;strong>Comment les d√©tecter le plus t√¥t possible?&lt;/strong>&lt;/p>
&lt;p>Comme les sites de &lt;em>phishing&lt;/em> servent souvent √† r√©cup√©rer des donn√©es confidentielles (n¬∞ de carte, mots de passe, etc), ils profitent de toutes les m√©thodes r√©centes pour r√©cup√©rer des certificats gratuits afin de se donner une belle image avec un joli cadenas dans la barre d&amp;rsquo;URL.&lt;/p>
&lt;p>Quelques recherches sur ce sujet m&amp;rsquo;a fait d√©couvrir un superbe projet de chez &lt;strong>Calidog&lt;/strong> : &lt;a class="link" href="https://certstream.calidog.io/" target="_blank" rel="noopener"
>&lt;strong>CertStream&lt;/strong>&lt;/a>. Ils mettent √† disposition un flux donnant en temps r√©el les certificats √©mis par &lt;em>Let&amp;rsquo;s Encrypt&lt;/em>, &lt;em>Cloudflare&lt;/em>, &lt;em>AWS&lt;/em>, &amp;hellip;&lt;/p>
&lt;p>Il ne reste plus qu&amp;rsquo;√† s&amp;rsquo;y connecter, faire une correspondance des domaines avec une &lt;em>regexp&lt;/em> pour avoir en temps r√©el, les possibles sites de &lt;em>phishing&lt;/em>.&lt;/p>
&lt;p>D&amp;rsquo;autres ont eu la m√™me id√©e : &lt;a class="link" href="https://github.com/AssuranceMaladieSec/CertStreamMonitor" target="_blank" rel="noopener"
>&lt;strong>CertStreamMonitor&lt;/strong>&lt;/a> mais les performances m&amp;rsquo;ont d√©√ßu (100% d&amp;rsquo;utilisation permanente d&amp;rsquo;un CORE) et j&amp;rsquo;ai trouv√© int√©ressant de le faire moi-m√™me.&lt;/p>
&lt;p>Je vous pr√©sente donc &lt;strong>&lt;a class="link" href="https://github.com/Issif/cercat" target="_blank" rel="noopener"
>Cercat&lt;/a>&lt;/strong> aka &lt;em>Certificate Catcher&lt;/em>.&lt;/p>
&lt;p>Le principe est simple, le service se connecte via &lt;em>websocket&lt;/em> au &lt;em>stream&lt;/em> de &lt;strong>Certstream&lt;/strong>, compare le domaine certifi√© √† une &lt;em>regexp&lt;/em> et si il y a correspondance, un message est post√© sur &lt;strong>Slack&lt;/strong> :&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/issif/cercat/master/screenshot.png"
loading="lazy"
alt="Certcat slack screenshot"
>&lt;/p>
&lt;p>et dans les logs :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">2020/04/14 17:29:40 [INFO] : A certificate for &amp;#39;www.XXXX.fr&amp;#39; has been issued : {&amp;#34;domain&amp;#34;:&amp;#34;www.XXXX.fr&amp;#34;,&amp;#34;SAN&amp;#34;:[&amp;#34;www.XXXX.fr&amp;#34;],&amp;#34;issuer&amp;#34;:&amp;#34;Let&amp;#39;s Encrypt&amp;#34;,&amp;#34;Addresses&amp;#34;:[&amp;#34;XX.XX.XX.183&amp;#34;,&amp;#34;XX.XX.XX.182&amp;#34;]}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2020/04/14 17:29:41 [INFO] : A certificate for &amp;#39;XXXX.fr&amp;#39; has been issued : {&amp;#34;domain&amp;#34;:&amp;#34;XXXX.fr&amp;#34;,&amp;#34;SAN&amp;#34;:[&amp;#34;mail.XXXX.fr&amp;#34;,&amp;#34;XXXX.fr&amp;#34;,&amp;#34;www.XXXX.fr&amp;#34;],&amp;#34;issuer&amp;#34;:&amp;#34;Let&amp;#39;s Encrypt&amp;#34;,&amp;#34;Addresses&amp;#34;:[&amp;#34;XX.XX.XX.108&amp;#34;]}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>La configuration est dans le &lt;a class="link" href="https://github.com/Issif/cercat/blob/master/README.md" target="_blank" rel="noopener"
>README&lt;/a> et des binaires pr√©-compil√©s sont fournis &lt;a class="link" href="https://github.com/Issif/cercat/releases" target="_blank" rel="noopener"
>ICI&lt;/a> parce que je suis gentil.&lt;/p>
&lt;p>En faisant des tests sur les domaines en &lt;code>.fr&lt;/code> je suis d&amp;rsquo;ailleurs tomb√© sur √ßa, un bel exemple de &lt;em>phishing&lt;/em> :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;domain&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;google-france.fr&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;SAN&amp;#34;&lt;/span>&lt;span class="p">:[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;eset.fr.nf&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;google-france.fr&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;page-accueil.info&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;www.eset.fr.nf&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;www.google-france.fr&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;www.page-accueil.info&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;issuer&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;Let&amp;#39;s Encrypt&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;Addresses&amp;#34;&lt;/span>&lt;span class="p">:[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;X.X.X.24&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>En esp√©rant que √ßa serve √† d&amp;rsquo;autres.&lt;/p>
&lt;p>&lt;em>Enjoy&lt;/em>&lt;/p></description></item><item><title>Falcosidekick 100k Pulls</title><link>https://thomas.labarussias.fr/posts/falcosidekick-100k-pulls/</link><pubDate>Tue, 18 Feb 2020 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/posts/falcosidekick-100k-pulls/</guid><description>&lt;p>Un petit post d&amp;rsquo;auto-promo (apr√®s des mois d&amp;rsquo;absences&amp;hellip;).&lt;/p>
&lt;p>J&amp;rsquo;ai not√© r√©cemment que mon petit &lt;code>falcosidekick&lt;/code> a d√©pass√© les &lt;em>100000 pulls&lt;/em> sur le &lt;code>DockerHub&lt;/code>. Je suis bluff√©, surtout que je sais que des entit√©s grosses et connues l&amp;rsquo;utilisent (je ne sais pas si je peux dire qui, donc je me tais, &lt;em>sorry&lt;/em>).&lt;/p>
&lt;p>Un petit graphe pour montrer l&amp;rsquo;historique (la l√©gende est illisible, mais les dates sont obtenables en survolant) :&lt;/p>
&lt;div>
&lt;svg class='line'>&lt;/svg>
&lt;script src="https://cdn.jsdelivr.net/npm/chart.xkcd@1/dist/chart.xkcd.min.js">&lt;/script>
&lt;script>
const svgline = document.querySelector('.line');
new chartXkcd.Line(svgline, {
title: 'Docker Pulls',
xLabel: 'Pulls',
yLabel: 'Date',
data: {
labels:['2019-08-28','2019-08-29','2019-08-30','2019-08-31','2019-09-01','2019-09-02','2019-09-03','2019-09-04','2019-09-05','2019-09-06','2019-09-07','2019-09-08','2019-09-09','2019-09-10','2019-09-11','2019-09-12','2019-09-13','2019-09-14','2019-09-15','2019-09-16','2019-09-17','2019-09-18','2019-09-19','2019-09-20','2019-09-21','2019-09-22','2019-09-23','2019-09-24','2019-09-25','2019-09-26','2019-09-27','2019-09-28','2019-09-29','2019-09-30','2019-10-01','2019-10-02','2019-10-03','2019-10-04','2019-10-05','2019-10-06','2019-10-07','2019-10-08','2019-10-09','2019-10-10','2019-10-11','2019-10-12','2019-10-13','2019-10-14','2019-10-15','2019-10-16','2019-10-17','2019-10-18','2019-10-19','2019-10-20','2019-10-21','2019-10-22','2019-10-23','2019-10-24','2019-10-25','2019-10-26','2019-10-27','2019-10-28','2019-10-29','2019-10-30','2019-10-31','2019-11-01','2019-11-02','2019-11-03','2019-11-04','2019-11-05','2019-11-06','2019-11-07','2019-11-08','2019-11-09','2019-11-10','2019-11-11','2019-11-12','2019-11-13','2019-11-14','2019-11-15','2019-11-16','2019-11-17','2019-11-18','2019-11-19','2019-11-20','2019-11-21','2019-11-22','2019-11-23','2019-11-24','2019-11-25','2019-11-26','2019-11-27','2019-11-28','2019-11-29','2019-11-30','2019-12-01','2019-12-02','2019-12-03','2019-12-04','2019-12-05','2019-12-06','2019-12-07','2019-12-08','2019-12-09','2019-12-10','2019-12-11','2019-12-12','2019-12-13','2019-12-14','2019-12-15','2019-12-16','2019-12-17','2019-12-18','2019-12-19','2019-12-20','2019-12-21','2019-12-22','2019-12-23','2019-12-24','2019-12-25','2019-12-26','2019-12-27','2019-12-28','2019-12-29','2019-12-30','2019-12-31','2020-01-01','2020-01-02','2020-01-03','2020-01-04','2020-01-05','2020-01-06','2020-01-07','2020-01-08','2020-01-09','2020-01-10','2020-01-11','2020-01-12','2020-01-13','2020-01-14','2020-01-15','2020-01-16','2020-01-17','2020-01-18','2020-01-19','2020-01-20','2020-01-21','2020-01-22','2020-01-23','2020-01-24','2020-01-25','2020-01-26','2020-01-27','2020-01-28','2020-01-29','2020-01-30','2020-01-31','2020-02-01','2020-02-02','2020-02-03','2020-02-04','2020-02-05','2020-02-06','2020-02-07','2020-02-08','2020-02-09','2020-02-10','2020-02-11','2020-02-12','2020-02-13','2020-02-14','2020-02-15','2020-02-16','2020-02-17','2020-02-18'],
datasets: [{
label: 'Pulls',
data: [2,2,9,106,108,134,173,434,492,615,761,761,816,950,1084,1104,1111,1111,1111,1157,1194,1210,1232,1232,1232,1232,1235,7685,7988,8042,8086,8086,8086,8087,8188,8200,8250,8373,8401,8408,8409,8524,8532,8603,8659,8707,8707,8771,8842,8992,9467,9713,9995,10255,10572,10903,10986,11041,11467,12042,12206,12277,12380,12470,12490,12642,12707,12783,13239,13754,14426,15159,15837,16155,16292,16776,17425,18001,18931,19596,20055,20321,20694,21490,22307,23572,24904,25591,25738,26321,27371,28516,29413,30216,30967,31052,31591,32710,34168,35164,35858,36239,36536,36849,37305,39011,40333,41472,42265,42508,43081,44534,45853,47028,47575,47880,47884,48428,48877,48882,49219,49683,49784,49786,49981,50538,50625,50860,51338,51413,51419,51501,51809,52676,53759,54978,55761,55828,56622,58214,59431,60331,62154,63643,64460,65872,67662,69453,71212,73267,74537,75335,76767,79124,81637,83863,86340,87692,88663,89862,91420,92794,94149,95124,95836,96571,97335,98296,99070,99906,100752,101480,102182,102885,103582],
}]
},
options: { // optional
yTickCount: 20,
}
});
&lt;/script>
&lt;/div>
&lt;p>Merci √† tous ceux qui l&amp;rsquo;utilisent et bien s√ªr √† toute l&amp;rsquo;√©quipe derri√®re &lt;code>falco&lt;/code>. J&amp;rsquo;ai d&amp;rsquo;autres id√©es en r√©serve pour am√©liorer, j&amp;rsquo;esp√®re avoir le temps de m&amp;rsquo;y atteler.&lt;/p>
&lt;p>&lt;em>Enjoy&lt;/em>&lt;/p></description></item><item><title>Falcosidekick 2.9.0 : nouvelle int√©gration et nouvel avatar</title><link>https://thomas.labarussias.fr/posts/falcosidekick-v-2-9-0-new-avatar/</link><pubDate>Sat, 05 Oct 2019 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/posts/falcosidekick-v-2-9-0-new-avatar/</guid><description>&lt;p>Je viens de sortir la version &lt;a class="link" href="https://github.com/falcosecurity/falcosidekick/releases/tag/2.9.0" target="_blank" rel="noopener"
>&lt;strong>2.9.0&lt;/strong>&lt;/a> de &lt;strong>falcosidekick&lt;/strong> et en outre un nouvel output, &lt;a class="link" href="https://www.opsgenie.com/" target="_blank" rel="noopener"
>&lt;strong>Opsgenie&lt;/strong>&lt;/a>, j&amp;rsquo;ai √©galement refait l&amp;rsquo;avatar du projet. Il est d√©sormais en couleurs et a une forme globale carr√©e, pour faciliter l&amp;rsquo;utilisation en ic√¥ne (&lt;strong>Slack&lt;/strong>, &lt;strong>Teams&lt;/strong>, &amp;hellip;).&lt;/p>
&lt;p>Voil√† le r√©sultat :&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/falcosecurity/falcosidekick/master/imgs/falcosidekick_color.png"
loading="lazy"
alt="falcosidekick new avatar"
>&lt;/p>
&lt;p>Ce qui donne ceci dans &lt;strong>Slack&lt;/strong> :&lt;/p>
&lt;p>&lt;img src="https://thomas.labarussias.fr/posts/falcosidekick-v-2-9-0-new-avatar/img/slack_with_new_falcosidekick_avatar.png"
width="794"
height="374"
srcset="https://thomas.labarussias.fr/posts/falcosidekick-v-2-9-0-new-avatar/img/slack_with_new_falcosidekick_avatar_hu_70021afb819a63fb.png 480w, https://thomas.labarussias.fr/posts/falcosidekick-v-2-9-0-new-avatar/img/slack_with_new_falcosidekick_avatar_hu_1228d059614975b2.png 1024w"
loading="lazy"
alt="slack avec le nouvel avatar"
class="gallery-image"
data-flex-grow="212"
data-flex-basis="509px"
>&lt;/p>
&lt;p>En ce qui concerne &lt;a class="link" href="https://www.opsgenie.com/" target="_blank" rel="noopener"
>&lt;strong>Opsgenie&lt;/strong>&lt;/a>, voil√† le r√©sultat :&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/falcosecurity/falcosidekick/master/docs/outputs/images/opsgenie.png"
loading="lazy"
alt="OpeGenie"
>&lt;/p>
&lt;p>Le repo &lt;a class="link" href="https://github.com/falcosecurity/falcosidekick" target="_blank" rel="noopener"
>Github&lt;/a> et l&amp;rsquo;image sur le &lt;a class="link" href="https://hub.docker.com/r/falcosecurity/falcosidekick/" target="_blank" rel="noopener"
>DockerHub&lt;/a>.&lt;/p>
&lt;p>&lt;em>Enjoy&lt;/em>&lt;/p></description></item><item><title>Falco Probes</title><link>https://thomas.labarussias.fr/posts/falco-probes/</link><pubDate>Mon, 23 Sep 2019 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/posts/falco-probes/</guid><description>&lt;p>Je tra√Æne pas mal sur le &lt;strong>slack&lt;/strong> de &lt;a class="link" href="https://sysdig.slack.com/" target="_blank" rel="noopener"
>&lt;strong>sysdig&lt;/strong>&lt;/a>, o√π on parle bien entendu de &lt;strong>falco&lt;/strong>. Un probl√®me tr√®s r√©current des utilisateurs est l&amp;rsquo;existence ou non de modules &lt;em>kernel&lt;/em> pr√©compil√©s pour leurs versions de &lt;em>kernel&lt;/em>.&lt;/p>
&lt;p>Quand le module n&amp;rsquo;est pas pr√©sent sur la machine h√¥te, l&amp;rsquo;installeur tente de le t√©l√©charger depuis un &lt;em>bucket S3&lt;/em>, c&amp;rsquo;est pratique, mais √©tant donn√© l&amp;rsquo;immense vari√©t√© d&amp;rsquo;architectures et de versions de &lt;em>kernel&lt;/em> dans la nature, impossible de tous les avoir tout pr√™ts au chaud sur &lt;em>S3&lt;/em>. Jusqu&amp;rsquo;√† pr√©sent, la seule mani√®re pour savoir si la version du module pour son &lt;em>kernel&lt;/em> est pr√©sente ou non sur le &lt;em>bucket&lt;/em> est d&amp;rsquo;aller sur la page indigeste qui est celle-ci : &lt;a class="link" href="https://s3.amazonaws.com/download.draios.com/stable/sysdig-probe-binaries/index.html" target="_blank" rel="noopener"
>https://s3.amazonaws.com/download.draios.com/stable/sysdig-probe-binaries/index.html&lt;/a>&lt;/p>
&lt;p>Pas tr√®s pratique (√ßa oblige √† faire du &lt;em>ctrl+F&lt;/em> pour recherhcer) et surtout la page est de plus en plus volumineuse.&lt;/p>
&lt;p>J&amp;rsquo;ai donc cod√© un petit machin qui parse cet &lt;em>index&lt;/em> et ressort le tout sous forme de tableaux dans lequels on peut chercher et √©galement transmettre les diens vers les modules.&lt;/p>
&lt;p>Le domaine est temporaire jusqu&amp;rsquo;√† nouvel ordre : &lt;strong>&lt;a class="link" href="https://thomas.labarussias.fr/falco-probes/?falcoversion=0.17.0" target="_blank" rel="noopener"
>https://thomas.labarussias.fr/falco-probes/?falcoversion=0.17.0&lt;/a>&lt;/strong>&lt;/p>
&lt;p>En esp√©rant que √ßa serve √† quelqu&amp;rsquo;un d&amp;rsquo;autre que moi, en tout cas c&amp;rsquo;est tr√®s pratique pour v√©rifier si les soucis d&amp;rsquo;installation de &lt;strong>falco&lt;/strong> d&amp;rsquo;une personne viennent de l&amp;rsquo;absence du module ou non.&lt;/p>
&lt;p>&lt;em>Enjoy&lt;/em>&lt;/p></description></item><item><title>Chart XKCD</title><link>https://thomas.labarussias.fr/posts/chart-xkcd/</link><pubDate>Thu, 12 Sep 2019 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/posts/chart-xkcd/</guid><description>&lt;p>Je suis tomb√© &lt;a class="link" href="https://github.com/timqian/chart.xkcd" target="_blank" rel="noopener"
>chart.xkcd&lt;/a> parmi les flux RSS que je suis. J&amp;rsquo;ai trouv√© l&amp;rsquo;id√©e amusante et le rendu agr√©able, j&amp;rsquo;en ai donc fait un micro &lt;em>shortcode&lt;/em> pour &lt;strong>Hugo&lt;/strong> :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">svg&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#39;{{ .Get &amp;#34;name&amp;#34; }}&amp;#39;&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">svg&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">script&lt;/span> &lt;span class="na">src&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;https://cdn.jsdelivr.net/npm/chart.xkcd@1/dist/chart.xkcd.min.js&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kr">const&lt;/span> &lt;span class="nx">svg&lt;/span>&lt;span class="p">{{&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nx">Get&lt;/span> &lt;span class="s2">&amp;#34;name&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">safeJS&lt;/span> &lt;span class="p">}}&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">document&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">querySelector&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;.{{ .Get &amp;#34;name&amp;#34; }}&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">new&lt;/span> &lt;span class="nx">chartXkcd&lt;/span>&lt;span class="p">.{{&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nx">Get&lt;/span> &lt;span class="s2">&amp;#34;type&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">safeJS&lt;/span> &lt;span class="p">}}(&lt;/span>&lt;span class="nx">svg&lt;/span>&lt;span class="p">{{&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nx">Get&lt;/span> &lt;span class="s2">&amp;#34;name&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">safeJS&lt;/span> &lt;span class="p">}},&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{{&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nx">Inner&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="nx">safeJS&lt;/span> &lt;span class="p">}}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>A caler dans &lt;code>layout/shortcodes/chart-xkcd.html&lt;/code>.&lt;/p>
&lt;p>Trois types de diagrammes sont dispos pour le moment : &lt;a class="link" href="#line" >&lt;strong>Line&lt;/strong>&lt;/a>, &lt;a class="link" href="#pie" >&lt;strong>Pie&lt;/strong>&lt;/a>, &lt;a class="link" href="#bar" >&lt;strong>Bar&lt;/strong>&lt;/a>, &lt;a class="link" href="#xy" >&lt;strong>XY&lt;/strong>&lt;/a>, &lt;a class="link" href="#radar" >&lt;strong>Radar&lt;/strong>&lt;/a>.&lt;/p>
&lt;p>Les options de chaque diagramme sont trouvables dans la &lt;a class="link" href="https://timqian.com/chart.xkcd/" target="_blank" rel="noopener"
>doc&lt;/a>.&lt;/p>
&lt;h2 id="exemples">Exemples
&lt;/h2>&lt;h3 id="line">Line
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{{&lt;/span>&lt;span class="o">&amp;lt;&lt;/span> &lt;span class="nx">chart&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">xkcd&lt;/span> &lt;span class="nx">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;line&amp;#34;&lt;/span> &lt;span class="nx">type&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;Line&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">}}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">title&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;A vs B&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">xLabel&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;Abscisse&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">yLabel&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;Ordonnee&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">data&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">labels&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;1&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;2&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;3&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;4&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;5&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;6&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s1">&amp;#39;7&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;8&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;9&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;10&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">datasets&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">label&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;A&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">data&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">30&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2500&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">300&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">250&lt;/span> &lt;span class="p">,&lt;/span>&lt;span class="mi">800&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1500&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2900&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5000&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">800&lt;/span>&lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">label&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;B&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">data&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">30&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">70&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">80&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">50&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">80&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">40&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">150&lt;/span>&lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">options&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">// optional
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">yTickCount&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{{&lt;/span>&lt;span class="o">&amp;lt;&lt;/span> &lt;span class="err">/chart-xkcd &amp;gt;}}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div>
&lt;svg class='line'>&lt;/svg>
&lt;script src="https://cdn.jsdelivr.net/npm/chart.xkcd@1/dist/chart.xkcd.min.js">&lt;/script>
&lt;script>
const svgline = document.querySelector('.line');
new chartXkcd.Line(svgline, {
title: 'A vs B',
xLabel: 'Abscisse',
yLabel: 'Ordonnee',
data: {
labels:['1', '2', '3', '4', '5', '6','7', '8', '9', '10'],
datasets: [{
label: 'A',
data: [30, 2500, 200, 300, 250 ,800, 1500, 2900, 5000, 800],
}, {
label: 'B',
data: [0, 145, 300, 770, 80, 45, 50, 1080, 40, 150],
}]
},
options: {
yTickCount: 10,
}
});
&lt;/script>
&lt;/div>
&lt;h3 id="pie">Pie
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{{&lt;/span>&lt;span class="o">&amp;lt;&lt;/span> &lt;span class="nx">chart&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">xkcd&lt;/span> &lt;span class="nx">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;pie&amp;#34;&lt;/span> &lt;span class="nx">type&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;Pie&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">}}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">title&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;A B C D E&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">data&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">labels&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="p">[&lt;/span> &lt;span class="s1">&amp;#39;A&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;B&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;C&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;D&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;E&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">datasets&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">data&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">122&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">60&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">130&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">44&lt;/span>&lt;span class="p">,],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">options&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">innerRadius&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mf">0.5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="c1">// mettre √† 0 pour obtenir un diagramme camembert (pie chart)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">legendPosition&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nx">chartXkcd&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">config&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">positionType&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">upRight&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{{&lt;/span>&lt;span class="o">&amp;lt;&lt;/span> &lt;span class="err">/chart-xkcd &amp;gt;}}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div>
&lt;svg class='pie'>&lt;/svg>
&lt;script src="https://cdn.jsdelivr.net/npm/chart.xkcd@1/dist/chart.xkcd.min.js">&lt;/script>
&lt;script>
const svgpie = document.querySelector('.pie');
new chartXkcd.Pie(svgpie, {
title: 'A B C D E',
data: {
labels:[ 'A', 'B', 'C', 'D', 'E'],
datasets: [{
data: [200, 122, 60, 130, 44,],
}]
},
options: {
innerRadius: 0.5,
legendPosition: chartXkcd.config.positionType.upRight,
}
});
&lt;/script>
&lt;/div>
&lt;h3 id="bar">Bar
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{{&lt;/span>&lt;span class="o">&amp;lt;&lt;/span> &lt;span class="nx">chart&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">xkcd&lt;/span> &lt;span class="nx">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;bar&amp;#34;&lt;/span> &lt;span class="nx">type&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;Bar&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">}}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">title&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;A B C D&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">data&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">labels&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;A&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;B&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;C&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;D&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">datasets&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">data&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">20&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">options&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">// optional
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">yTickCount&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">8&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{{&lt;/span>&lt;span class="o">&amp;lt;&lt;/span> &lt;span class="err">/chart-xkcd &amp;gt;}}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div>
&lt;svg class='bar'>&lt;/svg>
&lt;script src="https://cdn.jsdelivr.net/npm/chart.xkcd@1/dist/chart.xkcd.min.js">&lt;/script>
&lt;script>
const svgbar = document.querySelector('.bar');
new chartXkcd.Bar(svgbar, {
title: "A B C D",
data: {
labels:['A', 'B', 'C', 'D'],
datasets: [{
data: [20, 33, 5, 12],
}]
},
options: { // optional
yTickCount: 8,
}
});
&lt;/script>
&lt;/div>
&lt;h3 id="xy">XY
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{{&lt;/span>&lt;span class="o">&amp;lt;&lt;/span> &lt;span class="nx">chart&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">xkcd&lt;/span> &lt;span class="nx">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;xy&amp;#34;&lt;/span> &lt;span class="nx">type&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;XY&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">}}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">title&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;A vs B&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">xLabel&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;Abscisse&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">yLabel&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;Ordonnee&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">data&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">datasets&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">label&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;A&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">data&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[{&lt;/span> &lt;span class="nx">x&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">y&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">30&lt;/span> &lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">x&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">y&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">8&lt;/span> &lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">x&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">y&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">45&lt;/span> &lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">x&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">7&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">y&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">22&lt;/span> &lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">x&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">9&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">y&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">4&lt;/span> &lt;span class="p">}],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">label&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;B&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">data&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[{&lt;/span> &lt;span class="nx">x&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">y&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">12&lt;/span> &lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">x&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">y&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">20&lt;/span> &lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">x&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">6&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">y&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">53&lt;/span> &lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">x&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">y&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">12&lt;/span> &lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">x&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">y&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">20&lt;/span> &lt;span class="p">}],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">options&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">xTickCount&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">yTickCount&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">showLine&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">false&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">dotSize&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{{&lt;/span>&lt;span class="o">&amp;lt;&lt;/span> &lt;span class="err">/chart-xkcd &amp;gt;}}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div>
&lt;svg class='xy1'>&lt;/svg>
&lt;script src="https://cdn.jsdelivr.net/npm/chart.xkcd@1/dist/chart.xkcd.min.js">&lt;/script>
&lt;script>
const svgxy1 = document.querySelector('.xy1');
new chartXkcd.XY(svgxy1, {
title: 'A vs B',
xLabel: 'Abscisse',
yLabel: 'Ordonnee',
data: {
datasets: [{
label: 'A',
data: [{ x: 1, y: 30 }, { x: 3, y: 8 }, { x: 5, y: 45 }, { x: 7, y: 22 }, { x: 9, y: -4 }],
}, {
label: 'B',
data: [{ x: -2, y: 12 }, { x: 4, y: -20 }, { x: 6, y: 53 }, { x: 8, y: 12 }, { x: 10, y: 20 }],
}],
},
options: {
xTickCount: 10,
yTickCount: 10,
showLine: false,
dotSize: 1,
}
});
&lt;/script>
&lt;/div>
&lt;p>Avec &lt;code>options: {showLine: true}&lt;/code> :&lt;/p>
&lt;div>
&lt;svg class='xy2'>&lt;/svg>
&lt;script src="https://cdn.jsdelivr.net/npm/chart.xkcd@1/dist/chart.xkcd.min.js">&lt;/script>
&lt;script>
const svgxy2 = document.querySelector('.xy2');
new chartXkcd.XY(svgxy2, {
title: 'A vs B',
xLabel: 'Abscisse',
yLabel: 'Ordonnee',
data: {
datasets: [{
label: 'A',
data: [{ x: 1, y: 30 }, { x: 3, y: 8 }, { x: 5, y: 45 }, { x: 7, y: 22 }, { x: 9, y: -4 }],
}, {
label: 'B',
data: [{ x: -2, y: 12 }, { x: 4, y: -20 }, { x: 6, y: 53 }, { x: 8, y: 12 }, { x: 10, y: 20 }],
}],
},
options: {
xTickCount: 10,
yTickCount: 10,
showLine: true,
dotSize: 1,
}
});
&lt;/script>
&lt;/div>
&lt;h3 id="radar">Radar
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{{&lt;/span>&lt;span class="o">&amp;lt;&lt;/span> &lt;span class="nx">chart&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">xkcd&lt;/span> &lt;span class="nx">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;radar&amp;#34;&lt;/span> &lt;span class="nx">type&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;Radar&amp;#34;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">}}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">title&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;A vs B&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">data&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">labels&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;c&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;d&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;e&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">datasets&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">label&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;A&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">data&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">label&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;B&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">data&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">options&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">showLegend&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">dotSize&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">showLabels&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{{&lt;/span>&lt;span class="o">&amp;lt;&lt;/span> &lt;span class="err">/chart-xkcd &amp;gt;}}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div>
&lt;svg class='radar'>&lt;/svg>
&lt;script src="https://cdn.jsdelivr.net/npm/chart.xkcd@1/dist/chart.xkcd.min.js">&lt;/script>
&lt;script>
const svgradar = document.querySelector('.radar');
new chartXkcd.Radar(svgradar, {
title: 'A vs B',
data: {
labels: ['a', 'b', 'c', 'd', 'e'],
datasets: [{
label: 'A',
data: [3, 1, 3, 3, 2],
}, {
label: 'B',
data: [1, 3, 2, 3, 1],
}],
},
options: {
showLegend: true,
dotSize: .7,
showLabels: true,
},
});
&lt;/script>
&lt;/div></description></item><item><title>Falcosidekick 2.8.0</title><link>https://thomas.labarussias.fr/posts/falcosidekick-v-2-8-0/</link><pubDate>Wed, 11 Sep 2019 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/posts/falcosidekick-v-2-8-0/</guid><description>&lt;p>Nouvelle release, la &lt;a class="link" href="https://github.com/Issif/falcosidekick/releases/tag/2.8.0" target="_blank" rel="noopener"
>&lt;strong>2.8.0&lt;/strong>&lt;/a>, de mon proxy pour &lt;a class="link" href="https://falco.org/" target="_blank" rel="noopener"
>&lt;strong>falco&lt;/strong>&lt;/a>.&lt;/p>
&lt;p>La grosse feature √©tant l&amp;rsquo;ajout de &lt;a class="link" href="https://nats.io/" target="_blank" rel="noopener"
>&lt;strong>NATS&lt;/strong>&lt;/a> (une &lt;em>message queue&lt;/em> en &lt;strong>Go&lt;/strong>) comme sortie.&lt;/p>
&lt;p>Le repo &lt;a class="link" href="https://github.com/falcosecurity/falcosidekick" target="_blank" rel="noopener"
>Github&lt;/a> et l&amp;rsquo;image sur le &lt;a class="link" href="https://hub.docker.com/r/falcosecurity/falcosidekick/" target="_blank" rel="noopener"
>DockerHub&lt;/a>.&lt;/p>
&lt;p>&lt;em>Enjoy&lt;/em>&lt;/p></description></item><item><title>Utiliser k3d pour avoir un cluster k8s en local</title><link>https://thomas.labarussias.fr/posts/utiliser-k3d/</link><pubDate>Thu, 05 Sep 2019 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/posts/utiliser-k3d/</guid><description>&lt;p>Afin de parfaire mes connaissances sur &lt;a class="link" href="https://kubernetes.io/" target="_blank" rel="noopener"
>&lt;strong>kubernetes&lt;/strong>&lt;/a>, &lt;em>aka&lt;/em> &lt;strong>k8s&lt;/strong> pour les intimes, j&amp;rsquo;avais envie de monter un &lt;em>cluster&lt;/em> sur mon &lt;em>laptop&lt;/em>, pas juste un noeud tout seul. Jusqu&amp;rsquo;√† pr√©sent je n&amp;rsquo;avais test√© que des solutions pour avoir des &lt;strong>k8s&lt;/strong> mono-noeud, c&amp;rsquo;est sympa, mais trop √©loign√© de la r√©alit√©, surtout si on veut tester des m√©thodes de r√©silience, d&amp;rsquo;&lt;em>auto-scaling&lt;/em> de &lt;em>pods&lt;/em>, de &lt;em>deployments&lt;/em>, de &lt;em>daemonset&lt;/em>, etc.&lt;/p>
&lt;p>Et l√†, la r√©v√©lation ! Je connaissais d√©j√† &lt;a class="link" href="https://github.com/rancher/k3s" target="_blank" rel="noopener"
>&lt;strong>k3s&lt;/strong>&lt;/a>, le &lt;strong>k8s&lt;/strong> ultra all√©g√© de chez &lt;a class="link" href="https://rancher.com/" target="_blank" rel="noopener"
>&lt;strong>rancher&lt;/strong>&lt;/a> et il s&amp;rsquo;av√®re qu&amp;rsquo;ils ont d√©velopp√© un petit utilitaire pour monter un &lt;em>cluster&lt;/em> dans des &lt;em>containeurs&lt;/em> &lt;strong>docker&lt;/strong> avec, le bien nomm√© &lt;a class="link" href="https://github.com/rancher/k3d" target="_blank" rel="noopener"
>&lt;strong>k3d&lt;/strong>&lt;/a>.&lt;/p>
&lt;p>Apr√®s plusieurs heures de tests, je suis emball√©, c&amp;rsquo;est ultra rapide, ultra &lt;em>light&lt;/em> et √ßa fonctionne avec tous les outils classiques. Un &lt;strong>ingress controller&lt;/strong> bas√© sur &lt;strong>traefik&lt;/strong> est directement d√©ploy√©, donc on a de base un environnement fonctionnel. Simple. Efficace.&lt;/p>
&lt;h2 id="installation-de-k3d">Installation de k3d
&lt;/h2>&lt;p>Rien de compliqu√© pour l&amp;rsquo;installer, plusieurs m√©thodes sont fournies sur le &lt;a class="link" href="https://github.com/rancher/k3d#get" target="_blank" rel="noopener"
>repo Github officiel&lt;/a>. Comme c&amp;rsquo;est du &lt;strong>go&lt;/strong>, aucune d√©pendance. &lt;em>Easy&lt;/em>.&lt;/p>
&lt;h2 id="cr√©er-son-premier-cluster">Cr√©er son premier cluster
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">~ $ k3d create -n mon-cluster-test --publish &lt;span class="m">80&lt;/span> --publish &lt;span class="m">8080&lt;/span> --publish &lt;span class="m">443&lt;/span> -w &lt;span class="m">2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">2019/09/05 23:16:34 Created cluster network with ID cae80bddca7cf614494b9d97f7d6edf2b14d45864ef1aa0b1a899a93122ecc1b
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2019/09/05 23:16:34 Created docker volume k3d-mon-cluster-test-images
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2019/09/05 23:16:34 Creating cluster &lt;span class="o">[&lt;/span>mon-cluster-test&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2019/09/05 23:16:34 Creating server using docker.io/rancher/k3s:v0.7.0...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2019/09/05 23:16:34 Pulling image docker.io/rancher/k3s:v0.7.0...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2019/09/05 23:16:47 Booting &lt;span class="m">2&lt;/span> workers &lt;span class="k">for&lt;/span> cluster mon-cluster-test
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2019/09/05 23:16:48 Created worker with ID b0c019c001376c9aa07f8fb65b52da1b2d52fbe61f25cb24c7198c5b122a2a09
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2019/09/05 23:16:49 Created worker with ID a9d959899a2119606248bf8dd5d681f05efb7232d19c5f8206ffb5025f10885b
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2019/09/05 23:16:49 SUCCESS: created cluster &lt;span class="o">[&lt;/span>mon-cluster-test&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2019/09/05 23:16:49 You can now use the cluster with:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">KUBECONFIG&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>k3d get-kubeconfig --name&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;mon-cluster-test&amp;#39;&lt;/span>&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubectl cluster-info
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Sur ma machine, l&amp;rsquo;ex√©cution a pris environ 20s, en sachant que 95% du temps est li√© la r√©cup√©ration de l&amp;rsquo;image &lt;strong>k3s&lt;/strong>. Impressionnant.&lt;/p>
&lt;p>Une petite explication des arguments :&lt;/p>
&lt;ul>
&lt;li>&lt;code>-n&lt;/code> : le nom de notre cluster &lt;strong>k8s&lt;/strong>&lt;/li>
&lt;li>&lt;code>--publish 80 --publish 8080 --publish 443&lt;/code> : les ports qu&amp;rsquo;on va exposer, comme c&amp;rsquo;est fait avec la commande &lt;a class="link" href="https://docs.docker.com/engine/reference/run/#expose-incoming-ports" target="_blank" rel="noopener"
>&lt;em>docker run&lt;/em>&lt;/a>&lt;/li>
&lt;li>&lt;code>-w 2&lt;/code> : le nombre de &lt;em>workers&lt;/em> qu&amp;rsquo;on veut&lt;/li>
&lt;/ul>
&lt;p>On peut lister nos &lt;em>clusters&lt;/em> :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">~ $ k3d ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+------------------+------------------------------+---------+---------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> NAME &lt;span class="p">|&lt;/span> IMAGE &lt;span class="p">|&lt;/span> STATUS &lt;span class="p">|&lt;/span> WORKERS &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+------------------+------------------------------+---------+---------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> mon-cluster-test &lt;span class="p">|&lt;/span> docker.io/rancher/k3s:v0.7.0 &lt;span class="p">|&lt;/span> running &lt;span class="p">|&lt;/span> 2/2 &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+------------------+------------------------------+---------+---------+
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>L&amp;rsquo;image est effectivement de taille r√©duite (&lt;em>proportionnellement aux autres solutions&lt;/em>) :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">REPOSITORY TAG IMAGE ID CREATED SIZE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/k3s v0.7.0 f1ec9d3fbf66 &lt;span class="m">6&lt;/span> weeks ago 119MB
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="se-connecter-au-cluster">Se connecter au cluster
&lt;/h2>&lt;p>Comme pr√©cis√© dans les logs de cr√©ation, on peut r√©cup√©rer le &lt;em>kubeconfig&lt;/em> associ√© pour utiliser les outils classiques (&lt;a class="link" href="https://github.com/kubernetes/kubernetes/tree/master/pkg/kubectl" target="_blank" rel="noopener"
>&lt;strong>kubectl&lt;/strong>&lt;/a>, &lt;a class="link" href="https://github.com/derailed/k9s" target="_blank" rel="noopener"
>&lt;strong>k9s&lt;/strong>&lt;/a>, &lt;a class="link" href="https://github.com/helm/helm" target="_blank" rel="noopener"
>&lt;strong>helm&lt;/strong>&lt;/a>, etc) :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">~ $ &lt;span class="nb">export&lt;/span> &lt;span class="nv">KUBECONFIG&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>k3d get-kubeconfig --name&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;mon-cluster-test&amp;#39;&lt;/span>&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">~ $ kubectl get nodes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME STATUS ROLES AGE VERSION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">k3d-mon-cluster-test-server Ready master 2m v1.14.4-k3s.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">k3d-mon-cluster-test-worker-0 Ready worker 2m v1.14.4-k3s.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">k3d-mon-cluster-test-worker-1 Ready worker 2m v1.14.4-k3s.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="premier-d√©ploiement">Premier d√©ploiement
&lt;/h2>&lt;p>Afin de tester tout cela, nous allons appliquer un premier &lt;em>deployment&lt;/em> et tenter d&amp;rsquo;y acc√©der. Cela sera un simple &lt;em>micro-service&lt;/em> qui nous r√©pondra quelques infos sur lui-m√™me (sur quel &lt;em>noeud&lt;/em> il tourne, son nom, le contenu de la requ√™te &lt;em>HTTP&lt;/em> qu&amp;rsquo;il a re√ßue, etc). Le container qui sera utilis√© est fourni par ailleurs par ceux derri√®re &lt;strong>traefik&lt;/strong> : &lt;a class="link" href="https://hub.docker.com/r/containous/whoami" target="_blank" rel="noopener"
>&lt;strong>containous/whoami&lt;/strong>&lt;/a>.&lt;/p>
&lt;h3 id="cr√©ation-dun-namespace-d√©di√©">Cr√©ation d&amp;rsquo;un namespace d√©di√©
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">~ $ kubectl create namespace whoami
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>C&amp;rsquo;est juste histoire de bien segmenter les choses.&lt;/p>
&lt;h3 id="application-du-deployment">Application du &lt;em>deployment&lt;/em>
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">~ $ kubectl create deployment whoami --image&lt;span class="o">=&lt;/span>containous/whoami -n whoami
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="scaling-du-replicaset">&lt;em>Scaling&lt;/em> du &lt;em>replicaSet&lt;/em>
&lt;/h3>&lt;p>Nous avons un &lt;em>cluster&lt;/em> √† 2 noeuds, √ßa serait dommage de n&amp;rsquo;avoir qu&amp;rsquo;un seul &lt;em>pod&lt;/em>, augmentons √† 2 le &lt;em>replicaSet&lt;/em> associ√© :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">~ $ kubectl scale --replicas &lt;span class="m">2&lt;/span> deployment/whoami -n whoami
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">~ $ kubectl get rs -n whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME DESIRED CURRENT READY AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">whoami-756586b9ff &lt;span class="m">2&lt;/span> &lt;span class="m">2&lt;/span> &lt;span class="m">2&lt;/span> 4m33s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="cr√©ation-du-service">Cr√©ation du &lt;em>service&lt;/em>
&lt;/h3>&lt;p>Nous avons 2 &lt;em>pods&lt;/em>, nous allons cr√©er un &lt;em>service&lt;/em> pour avoir une r√©partition de charge :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">~ $ kubectl create service clusterip whoami --tcp&lt;span class="o">=&lt;/span>80:80 -n whoami
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="cr√©ation-de-lingress">Cr√©ation de l&amp;rsquo;&lt;em>ingress&lt;/em>
&lt;/h3>&lt;p>Tout est pr√™t au sein de notre &lt;em>cluster&lt;/em>, il est temps de nous permettre d&amp;rsquo;acc√©der √† notre &lt;em>micro-service&lt;/em>, on va utiliser une ressource de type &lt;em>ingress&lt;/em> :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">~ $ cat &lt;span class="s">&amp;lt;&amp;lt;EOF | kubectl apply -n whoami -f -
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">apiVersion: extensions/v1beta1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">kind: Ingress
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">metadata:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> name: whoami
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> annotations:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> ingress.kubernetes.io/ssl-redirect: &amp;#34;false&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">spec:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> rules:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> - http:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> paths:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> - path: /
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> backend:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> serviceName: whoami
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> servicePort: 80
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="testons-le-micro-service">Testons le &lt;em>micro-service&lt;/em>
&lt;/h3>&lt;p>A la cr√©ation du cluster, nous avons publier le port 80 au niveau de l&amp;rsquo;host, il est temps de trouver le port qui a √©t√© associ√© (&lt;em>bind&lt;/em>) :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">~ $ docker inspect --format&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;{{range $p, $conf := .NetworkSettings.Ports}} {{$p}} -&amp;gt; {{(index $conf 0).HostPort}} {{end}}&amp;#39;&lt;/span> &lt;span class="k">$(&lt;/span>docker ps --filter &lt;span class="s2">&amp;#34;name=k3d-mon-cluster-test-server&amp;#34;&lt;/span> -q&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">443/tcp -&amp;gt; &lt;span class="m">32810&lt;/span> 6443/tcp -&amp;gt; &lt;span class="m">6443&lt;/span> 80/tcp -&amp;gt; &lt;span class="m">32811&lt;/span> 8080/tcp -&amp;gt; &lt;span class="m">32809&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>L&amp;rsquo;&lt;em>ingress&lt;/em> √©coute sur le port 80, le port associ√© est donc le 32811 dans mon cas. Faisons plusieurs appels et v√©rifions :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">~ $ curl http://localhost:32811
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hostname: whoami-756586b9ff-4mqb6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IP: 127.0.0.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IP: ::1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IP: 10.42.2.4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IP: fe80::a89f:5eff:fef5:d426
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">RemoteAddr: 10.42.1.3:36824
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">GET / HTTP/1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host: localhost:32811
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">User-Agent: curl/7.47.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept: */*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept-Encoding: gzip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">X-Forwarded-For: 10.42.1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">X-Forwarded-Host: localhost:32811
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">X-Forwarded-Port: &lt;span class="m">32811&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">X-Forwarded-Proto: http
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">X-Forwarded-Server: traefik-56688c4464-wlk2r
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">X-Real-Ip: 10.42.1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">~ $ curl http://localhost:32811
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hostname: whoami-756586b9ff-6wn52
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IP: 127.0.0.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IP: ::1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IP: 10.42.0.4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IP: fe80::7c0f:1fff:fe2b:bcb2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">RemoteAddr: 10.42.1.3:41180
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">GET / HTTP/1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host: localhost:32811
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">User-Agent: curl/7.47.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept: */*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept-Encoding: gzip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">X-Forwarded-For: 10.42.1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">X-Forwarded-Host: localhost:32811
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">X-Forwarded-Port: &lt;span class="m">32811&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">X-Forwarded-Proto: http
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">X-Forwarded-Server: traefik-56688c4464-wlk2r
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">X-Real-Ip: 10.42.1.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Nous avons bien 2 r√©ponses diff√©rentes :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">Hostname: whoami-756586b9ff-4mqb6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IP: 10.42.2.4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hostname: whoami-756586b9ff-6wn52
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IP: 10.42.0.4
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Qui correspondent √† nos 2 &lt;em>pods&lt;/em> :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">~ $ kubectl get pods -n whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">whoami-756586b9ff-4mqb6 1/1 Running &lt;span class="m">0&lt;/span> 24m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">whoami-756586b9ff-6wn52 1/1 Running &lt;span class="m">0&lt;/span> 20m
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;em>Enjoy&lt;/em>&lt;/p></description></item><item><title>Falcosidekick fait d√©sormais partie de l'organisation Falcosecurity</title><link>https://thomas.labarussias.fr/posts/falcosidekick-migre-vers-falcosecurity/</link><pubDate>Wed, 28 Aug 2019 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/posts/falcosidekick-migre-vers-falcosecurity/</guid><description>&lt;p>Les mainteneurs de &lt;strong>falco&lt;/strong> m&amp;rsquo;ont propos√© de migrer &lt;strong>falcosidekick&lt;/strong> au sein de l&amp;rsquo;organisation officielle &lt;strong>falcosecurity&lt;/strong>. Il devient donc un projet officiel üéâüòç.&lt;/p>
&lt;p>Le repo &lt;a class="link" href="https://github.com/falcosecurity/falcosidekick" target="_blank" rel="noopener"
>Github&lt;/a> et l&amp;rsquo;image sur le &lt;a class="link" href="https://hub.docker.com/r/falcosecurity/falcosidekick/" target="_blank" rel="noopener"
>DockerHub&lt;/a>.&lt;/p>
&lt;p>Au passage, j&amp;rsquo;ai sorti la &lt;a class="link" href="https://github.com/Issif/falcosidekick/releases/tag/2.7.1" target="_blank" rel="noopener"
>&lt;strong>2.7.1&lt;/strong>&lt;/a> qui met √† jour la version de Go utilis√©e (1.12).&lt;/p>
&lt;p>&lt;em>Enjoy&lt;/em>&lt;/p></description></item><item><title>Falcosidekick 2.7.0</title><link>https://thomas.labarussias.fr/posts/falcosidekick-v-2-7-0/</link><pubDate>Tue, 27 Aug 2019 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/posts/falcosidekick-v-2-7-0/</guid><description>&lt;p>Nouvelle release, la &lt;a class="link" href="https://github.com/Issif/falcosidekick/releases/tag/2.7.0" target="_blank" rel="noopener"
>&lt;strong>2.7.0&lt;/strong>&lt;/a>, de mon proxy pour &lt;a class="link" href="https://falco.org/" target="_blank" rel="noopener"
>&lt;strong>falco&lt;/strong>&lt;/a>.&lt;/p>
&lt;p>La grosse feature √©tant l&amp;rsquo;ajout de &lt;a class="link" href="https://grafana.com/oss/loki" target="_blank" rel="noopener"
>&lt;strong>Loki&lt;/strong>&lt;/a> comme sortie :&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/falcosecurity/falcosidekick/master/docs/outputs/images/loki.png"
loading="lazy"
alt="Grafana Loki"
>&lt;/p>
&lt;p>Le repo &lt;a class="link" href="https://github.com/falcosecurity/falcosidekick" target="_blank" rel="noopener"
>Github&lt;/a> et l&amp;rsquo;image sur le &lt;a class="link" href="https://hub.docker.com/r/falcosecurity/falcosidekick/" target="_blank" rel="noopener"
>DockerHub&lt;/a>.&lt;/p>
&lt;p>&lt;em>Enjoy&lt;/em>&lt;/p></description></item><item><title>Falcosidekick 2.6.0</title><link>https://thomas.labarussias.fr/posts/falcosidekick-v-2-6-0/</link><pubDate>Mon, 26 Aug 2019 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/posts/falcosidekick-v-2-6-0/</guid><description>&lt;p>Nouvelle release, la &lt;a class="link" href="https://github.com/Issif/falcosidekick/releases/tag/2.6.0" target="_blank" rel="noopener"
>&lt;strong>2.6.0&lt;/strong>&lt;/a>, de mon proxy pour &lt;a class="link" href="https://falco.org/" target="_blank" rel="noopener"
>&lt;strong>falco&lt;/strong>&lt;/a>.&lt;/p>
&lt;p>La grosse feature √©tant l&amp;rsquo;ajout du &lt;strong>SMTP&lt;/strong> (envoi d&amp;rsquo;email) comme sortie :&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/falcosecurity/falcosidekick/master/docs/outputs/images/smtp_html.png"
loading="lazy"
alt="SMTP html"
>&lt;/p>
&lt;p>Afin de respecter les standards, la version &lt;em>html&lt;/em> contient √©galement la version &lt;em>plaintext&lt;/em>. Il est aussi possible d&amp;rsquo;envoyer uniquement la version &lt;em>plaintext&lt;/em>, utile pour certains syst√®mes de &lt;em>ticketing&lt;/em> qui utilisent l&amp;rsquo;email pour la cr√©ation.&lt;/p>
&lt;p>Le repo &lt;a class="link" href="https://github.com/falcosecurity/falcosidekick" target="_blank" rel="noopener"
>Github&lt;/a> et l&amp;rsquo;image sur le &lt;a class="link" href="https://hub.docker.com/r/falcosecurity/falcosidekick/" target="_blank" rel="noopener"
>DockerHub&lt;/a>.&lt;/p>
&lt;p>&lt;em>Enjoy&lt;/em>&lt;/p></description></item><item><title>Proxifier Traefik par Traefik</title><link>https://thomas.labarussias.fr/posts/traefik-proxyfier-dashboard/</link><pubDate>Mon, 26 Aug 2019 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/posts/traefik-proxyfier-dashboard/</guid><description>&lt;p>&lt;a class="link" href="https://traefik.io/" target="_blank" rel="noopener"
>&lt;strong>Traefik&lt;/strong>&lt;/a> poss√®de une &lt;em>UI&lt;/em> basique qui est par d√©faut expos√©e sur un port diff√©rent. Il est possible de faire en sorte que &lt;strong>Traefik&lt;/strong> serve lui m√™me de proxy, cela permet :&lt;/p>
&lt;ul>
&lt;li>ne plus avoir √† utiliser un port diff√©rent pour acc√©der l&amp;rsquo;&lt;em>UI&lt;/em>, mais un domaine classique (&amp;quot;&lt;em>traefik.mondomaine.net&lt;/em>&amp;quot; par ex.)&lt;/li>
&lt;li>forcer l&amp;rsquo;acc√®s en http&lt;strong>s&lt;/strong> avec en prime un certificat &lt;a class="link" href="https://letsencrypt.org/fr/" target="_blank" rel="noopener"
>&lt;em>Let&amp;rsquo;s Encrypt&lt;/em>&lt;/a> automatique et gratuit&lt;/li>
&lt;li>permettre de rajouter une authentification, par d√©faut, l&amp;rsquo;&lt;em>UI&lt;/em> est ouverte √† tout une fois activ√©e&lt;/li>
&lt;/ul>
&lt;p>Dans mon cas, je fais tourner &lt;strong>Traefik&lt;/strong> dans un container, mais √ßa marchera pareil si vous le fa√Ætes tourner directement sur l&amp;rsquo;&lt;em>host&lt;/em>, prenez juste soin de filtrer le port de l&amp;rsquo;&lt;em>UI&lt;/em> (&lt;em>8080&lt;/em> par d√©faut) pour qu&amp;rsquo;il n&amp;rsquo;accepte que les connexions de la boucle local (&lt;em>127.0.0.1&lt;/em>).&lt;/p>
&lt;p>Voil√† ce qu&amp;rsquo;il faut avoir √† minima dans sa configuration &lt;em>config.toml&lt;/em> :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="line">&lt;span class="cl">&lt;span class="c">################################################################&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Configuration globale&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">################################################################&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">defaultEntryPoints&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;http&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;https&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">entryPoints&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[&lt;/span>&lt;span class="nx">entryPoints&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">http&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">address&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;:80&amp;#34;&lt;/span> &lt;span class="c"># traefik ecoute sur le port 80&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[&lt;/span>&lt;span class="nx">entryPoints&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">redirect&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">entryPoint&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;https&amp;#34;&lt;/span> &lt;span class="c"># redirection http &amp;gt; https&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[&lt;/span>&lt;span class="nx">entryPoints&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">https&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">address&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;:443&amp;#34;&lt;/span> &lt;span class="c"># traefik ecoute sur le port 443&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[&lt;/span>&lt;span class="nx">entryPoints&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">https&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">tls&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">minVersion&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;VersionTLS12&amp;#34;&lt;/span> &lt;span class="c"># version minimum de TLS acceptee&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[&lt;/span>&lt;span class="nx">entryPoints&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ui&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">address&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s2">&amp;#34;127.0.0.1:8080&amp;#34;&lt;/span> &lt;span class="c"># on ecoute uniquement sur la boucle locale pour ce port&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[&lt;/span>&lt;span class="nx">entryPoints&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ui&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">auth&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[&lt;/span>&lt;span class="nx">entryPoints&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ui&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">auth&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">basic&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">users&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;XXXX:YYYY&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="c"># les identifiants au format htpasswd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">################################################################&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Configuration pour let&amp;#39;s encrypt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">################################################################&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">acme&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">email&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;xxx@yyy.zzz&amp;#34;&lt;/span> &lt;span class="c"># votre mail pour lets encrypt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">storage&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;/certs/acme.json&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">entryPoint&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;https&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">onDemand&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span> &lt;span class="c"># demande automatique de certificat&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">acmeLogging&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[&lt;/span>&lt;span class="nx">acme&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">httpChallenge&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">entryPoint&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;http&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">################################################################&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Configuration de l&amp;#39;API de Traefik&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">################################################################&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">api&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">entryPoint&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;ui&amp;#34;&lt;/span> &lt;span class="c"># l API ecoutera sur cet entrypoint&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">dashboard&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[&lt;/span>&lt;span class="nx">api&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">statistics&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">recentErrors&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">50&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">################################################################&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Configuration pour l&amp;#39;UI de Traefik&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">################################################################&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">file&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">frontends&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[&lt;/span>&lt;span class="nx">frontends&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ui&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">backend&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;ui&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">passHostHeader&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[&lt;/span>&lt;span class="nx">frontends&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ui&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">routes&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">default&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">rule&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;Host:ui.mondomaine.net&amp;#34;&lt;/span> &lt;span class="c"># votre domaine a configurer&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">backends&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[&lt;/span>&lt;span class="nx">backends&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ui&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[&lt;/span>&lt;span class="nx">backends&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ui&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">servers&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">default&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">url&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;http://127.0.0.1:8080&amp;#34;&lt;/span> &lt;span class="c"># le backend a utiliser qui s avere etre l entrypoint de l API&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;em>Enjoy&lt;/em>&lt;/p></description></item><item><title>Conversion de Types en Go</title><link>https://thomas.labarussias.fr/posts/golang-conversion-types/</link><pubDate>Wed, 21 Aug 2019 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/posts/golang-conversion-types/</guid><description>&lt;hr>
&lt;h1 id="int64--string">int64 ü†Æ string
&lt;/h1>&lt;h2 id="formatint">&lt;a class="link" href="https://golang.org/pkg/strconv/#FormatInt" target="_blank" rel="noopener"
>FormatInt&lt;/a>
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">strconv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">FormatInt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="kt">int64&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">base&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="itoa">&lt;a class="link" href="https://golang.org/pkg/strconv/#Itoa" target="_blank" rel="noopener"
>Itoa&lt;/a>
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">strconv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Itoa&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Itoa is equivalent to FormatInt(int64(i), 10). &lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="string--int64">string ü†Æ int64
&lt;/h1>&lt;h2 id="parseint">&lt;a class="link" href="https://golang.org/pkg/strconv/#ParseInt" target="_blank" rel="noopener"
>ParseInt&lt;/a>
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">strconv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ParseInt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">base&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">bitSize&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="atoi">&lt;a class="link" href="https://golang.org/pkg/strconv/#Atoi" target="_blank" rel="noopener"
>Atoi&lt;/a>
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">strconv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Atoi&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Atoi is equivalent to ParseInt(s, 10, 0), converted to type int. &lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="string--time">string ü†Æ Time
&lt;/h1>&lt;ul>
&lt;li>Pour le &lt;a class="link" href="https://godoc.org/time#pkg-constants" target="_blank" rel="noopener"
>layout&lt;/a>.&lt;/li>
&lt;li>Pour la &lt;a class="link" href="https://godoc.org/time#LoadLocation" target="_blank" rel="noopener"
>location&lt;/a>.&lt;/li>
&lt;/ul>
&lt;h2 id="parse">&lt;a class="link" href="https://godoc.org/time#Parse" target="_blank" rel="noopener"
>Parse&lt;/a>
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Parse&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">layout&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">value&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="parseinlocation">&lt;a class="link" href="https://godoc.org/time#ParseInLocation" target="_blank" rel="noopener"
>ParseInLocation&lt;/a>
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ParseInLocation&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">layout&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">value&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">loc&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Location&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="time--string">Time ü†Æ string
&lt;/h1>&lt;p>Pour le &lt;a class="link" href="https://godoc.org/time#pkg-constants" target="_blank" rel="noopener"
>layout&lt;/a>.&lt;/p>
&lt;h2 id="timeformat">&lt;a class="link" href="https://godoc.org/time#Time.Format" target="_blank" rel="noopener"
>Time.Format&lt;/a>
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">var&lt;/span> &lt;span class="nx">t&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Time&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">t&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Format&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">layout&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>D√©coder du base64 en Go</title><link>https://thomas.labarussias.fr/posts/decoder-du-base64-en-go/</link><pubDate>Mon, 19 Aug 2019 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/posts/decoder-du-base64-en-go/</guid><description>&lt;p>Je tentais de d√©coder la partie &lt;em>payload&lt;/em> d&amp;rsquo;un token &lt;em>JWT&lt;/em> (&lt;a class="link" href="https://scotch.io/tutorials/the-anatomy-of-a-json-web-token" target="_blank" rel="noopener"
>https://scotch.io/tutorials/the-anatomy-of-a-json-web-token&lt;/a>) quand j&amp;rsquo;ai eu l&amp;rsquo;erreur suivante :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">panic: illegal base64 data at input byte &lt;span class="m">349&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Ma fa√ßon de faire √©tait pourtant classique et a toujours fonctionn√© auparavant :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">base64&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">StdEncoding&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">DecodeString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Et le d√©codage du &lt;em>string&lt;/em> via un autre outil ne posait pas de souci. üòß&lt;/p>
&lt;p>La solution se trouvait une fois de plus dans la documentation de &lt;strong>Go&lt;/strong> : &lt;a class="link" href="https://golang.org/pkg/encoding/base64/#pkg-variables" target="_blank" rel="noopener"
>https://golang.org/pkg/encoding/base64/#pkg-variables&lt;/a>&lt;/p>
&lt;p>Il existe plusieurs fonctions de d√©codage qui prennent ou non en compte les caract√®res de &lt;em>padding&lt;/em>, en changeant pour :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">base64&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">RawStdEncoding&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">DecodeString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Mon &lt;em>payload&lt;/em> √©tait d√©cod√©.&lt;/p>
üëç</description></item><item><title>A propos</title><link>https://thomas.labarussias.fr/about/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/about/</guid><description>&lt;p>Mon profil &lt;a class="link" href="https://www.linkedin.com/in/thomas-labarussias/" target="_blank" rel="noopener"
>Linkedin&lt;/a>&lt;/p>
&lt;p>TL;DR:&lt;/p>
&lt;ul>
&lt;li>Ing√©nieur dipl√¥m√© des Arts &amp;amp; M√©tiers en conception m√©canique et gestion de production industrielle&lt;/li>
&lt;li>Utilisateur de GNU/Linux depuis 2 d√©cennies&lt;/li>
&lt;li>Passionn√© de m√©trologie/monitoring&lt;/li>
&lt;li>Fondamentalement un OPS (DevOPS/SRE)&lt;/li>
&lt;li>7 ans d&amp;rsquo;astreinte&lt;/li>
&lt;li>FinOps&lt;/li>
&lt;li>Go developer&lt;/li>
&lt;li>OSS contributor&lt;/li>
&lt;li>DevRel&lt;/li>
&lt;li>Speaker&lt;/li>
&lt;/ul></description></item><item><title>Archives</title><link>https://thomas.labarussias.fr/archives/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/archives/</guid><description/></item><item><title>Search</title><link>https://thomas.labarussias.fr/search/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/search/</guid><description/></item><item><title>Talks</title><link>https://thomas.labarussias.fr/talks/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://thomas.labarussias.fr/talks/</guid><description>&lt;p>A titres personnel et professionnel, j&amp;rsquo;ai eu le privil√®ge au cours des ann√©es de donner de nombreuses conf√©rences et de participer √† des podcasts en tant qu&amp;rsquo;invit√©.&lt;/p>
&lt;p>Vous trouverez ci-dessous une liste (non exhaustive) de ces conf√©rences et podcasts dont les captations sont en ligne.&lt;/p>
&lt;h3 id="2024">2024
&lt;/h3>&lt;ul>
&lt;li>&amp;#x1f1eb;&amp;#x1f1f7; &lt;a class="link" href="https://www.podcastics.com/podcast/episode/table-ronde-sur-lopen-source-283257/" target="_blank" rel="noopener"
>&lt;code>Table Ronde sur l'Open Source (WeSpeakCloud)&lt;/code>&lt;/a>&lt;/li>
&lt;li>&amp;#x1f1eb;&amp;#x1f1f7; &lt;a class="link" href="https://www.youtube.com/watch?v=9P65jDKf8MM" target="_blank" rel="noopener"
>&lt;code>S√©curit√© des conteneurs avec Falco ! - WORKSHOP COMPLET&lt;/code>&lt;/a>&lt;/li>
&lt;li>&amp;#x1f1eb;&amp;#x1f1f7; &lt;a class="link" href="https://www.youtube.com/watch?v=Mx28fhyKX7Q" target="_blank" rel="noopener"
>&lt;code>R√©agir √† temps aux menaces dans Kubernetes avec Falco (Voxxed Days Luxembourg 2024)&lt;/code>&lt;/a>&lt;/li>
&lt;li>&amp;#x1f1ec;&amp;#x1f1e7; &lt;a class="link" href="https://www.youtube.com/watch?v=ScluwvDdYqg" target="_blank" rel="noopener"
>&lt;code>Let‚Äôs dissect malwares by collecting their syscalls with eBPF (KCD Czech &amp;amp; Slovak 2024)&lt;/code>&lt;/a>&lt;/li>
&lt;li>&amp;#x1f1ec;&amp;#x1f1e7; &lt;a class="link" href="https://www.youtube.com/watch?v=8V0I5ygZz3Q&amp;amp;t=186s" target="_blank" rel="noopener"
>&lt;code>Innovations and Interviews (KCD Istanbul 2024)&lt;/code>&lt;/a>&lt;/li>
&lt;li>&amp;#x1f1ec;&amp;#x1f1e7; &lt;a class="link" href="https://www.youtube.com/watch?v=bzDWBihArQY&amp;amp;t=72s" target="_blank" rel="noopener"
>&lt;code>Cloud-native threat detection with Falco&lt;/code>&lt;/a>&lt;/li>
&lt;li>&amp;#x1f1ec;&amp;#x1f1e7; &lt;a class="link" href="https://www.youtube.com/watch?v=csKxijmMVNk" target="_blank" rel="noopener"
>&lt;code>How Falco Brought Real-Time Observability to Infrastructure&lt;/code>&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="2023">2023
&lt;/h3>&lt;ul>
&lt;li>&amp;#x1f1eb;&amp;#x1f1f7; &lt;a class="link" href="https://www.podcastics.com/podcast/episode/falco-244969/" target="_blank" rel="noopener"
>&lt;code>Falco (WeSpeakCloud)&lt;/code>&lt;/a>&lt;/li>
&lt;li>&amp;#x1f1ec;&amp;#x1f1e7; &lt;a class="link" href="https://www.youtube.com/watch?v=m6rEiKAkWK8" target="_blank" rel="noopener"
>&lt;code>Use Falco and eBPF to protect your applications (Conf42 Observability 2023)&lt;/code>&lt;/a>&lt;/li>
&lt;li>&amp;#x1f1ec;&amp;#x1f1e7; &lt;a class="link" href="https://youtu.be/zThi9fnUXwE?t=110" target="_blank" rel="noopener"
>&lt;code>What happened in Kubecon Amsterdam (Interview) (KubeCon Europe 2023)&lt;/code>&lt;/a>&lt;/li>
&lt;li>&amp;#x1f1ec;&amp;#x1f1e7; &lt;a class="link" href="https://www.youtube.com/watch?v=sAmiBCt3qc4" target="_blank" rel="noopener"
>&lt;code>Enhanced Security for Multi-Tenant Architectures: Key Components and Best Practices (Multi-Tenancy Con 2023)&lt;/code>&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="2022">2022
&lt;/h3>&lt;ul>
&lt;li>&amp;#x1f1eb;&amp;#x1f1f7; &lt;a class="link" href="https://www.youtube.com/watch?v=5VSjIrSM3Tw" target="_blank" rel="noopener"
>&lt;code>D√©tecter et r√©agir aux menaces contre votre cluster Kubernetes avec Falco (Open Source Experience 2022)&lt;/code>&lt;/a>&lt;/li>
&lt;li>&amp;#x1f1eb;&amp;#x1f1f7; &lt;a class="link" href="https://www.youtube.com/watch?v=haQGJUZ2RWw" target="_blank" rel="noopener"
>&lt;code>D√©tecter et g√©rer la s√©curit√© dans un contexte Kubernetes (Meetup CNCF X WeScale)&lt;/code>&lt;/a>&lt;/li>
&lt;li>&amp;#x1f1ec;&amp;#x1f1e7; &lt;a class="link" href="https://www.youtube.com/watch?v=KFt2gwlslb8" target="_blank" rel="noopener"
>&lt;code>Extend Falco with Plugins: Trigger Alerts with any Stream of Events (CNCF)&lt;/code>&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="2021">2021
&lt;/h3>&lt;ul>
&lt;li>&amp;#x1f1eb;&amp;#x1f1f7; &lt;a class="link" href="https://medium.com/electro-monkeys/74-argocd-et-l%C3%A8re-du-gitops-avec-thomas-labarussias-et-victor-boissi%C3%A8re-45d33beabed0" target="_blank" rel="noopener"
>&lt;code>ArgoCD et l‚Äô√®re du GitOps (Electro Monkeys)&lt;/code>&lt;/a>&lt;/li>
&lt;li>&amp;#x1f1eb;&amp;#x1f1f7; &lt;a class="link" href="https://youtu.be/1TY2M6RyalU?list=PLZ_TUMnTqfu87lInu7CV6YugTehBRgw1C&amp;amp;t=4280" target="_blank" rel="noopener"
>&lt;code>Ajuster la taille de son cluster Kubernetes pour aider les d√©veloppeurs dans leurs recettes (Meetup AWS User Group Paris)&lt;/code>&lt;/a> (&lt;a class="link" href="https://docs.google.com/presentation/d/1ABG4XnZdBSTZ1wwHlFm3ROB1N84uFDZPsRRIUvRfDkQ/edit?usp=sharing" target="_blank" rel="noopener"
>&lt;em>slides&lt;/em>&lt;/a>)&lt;/li>
&lt;li>&amp;#x1f1eb;&amp;#x1f1f7; &lt;a class="link" href="https://www.youtube.com/watch?v=3CU5yu-TdNU" target="_blank" rel="noopener"
>&lt;code>D√©tection et R√©action aux menaces dans Kubernetes avec Falco (Paris Container Days 2021)&lt;/code>&lt;/a> (&lt;a class="link" href="https://docs.google.com/presentation/d/1qGaIWUhNKMdGLb8YwetmbKFxFyY1krvy_c8A7hzg-Nk/edit?usp=sharing" target="_blank" rel="noopener"
>&lt;em>slides&lt;/em>&lt;/a>)&lt;/li>
&lt;li>&amp;#x1f1eb;&amp;#x1f1f7; &lt;a class="link" href="https://www.youtube.com/watch?v=4jPlzr1-Oek" target="_blank" rel="noopener"
>&lt;code>Continuous Deployment d‚Äôapplications dans Kubernetes avec Argo CD (DevNation Day France 2021)&lt;/code>&lt;/a>&lt;/li>
&lt;li>&amp;#x1f1eb;&amp;#x1f1f7; &lt;a class="link" href="https://youtu.be/UCXyHRhPbdg?t=2138" target="_blank" rel="noopener"
>&lt;code>D√©tection et r√©action aux menaces dans Kubernetes - Meetup CNCF Paris&lt;/code>&lt;/a>&lt;/li>
&lt;li>&amp;#x1f1eb;&amp;#x1f1f7; &lt;a class="link" href="https://www.youtube.com/watch?v=bzDWBihArQY&amp;amp;t=72s" target="_blank" rel="noopener"
>&lt;code>Ajuster la taille de son cluster Kubernetes pour aider les d√©veloppeurs dans leurs recettes (AWS User Group France)&lt;/code>&lt;/a>&lt;/li>
&lt;li>&amp;#x1f1ec;&amp;#x1f1e7; &lt;a class="link" href="https://youtu.be/UCXyHRhPbdg?t=2114" target="_blank" rel="noopener"
>&lt;code>Detection and Reaction to threats in Kubernetes (Cloud Native Computing Paris)&lt;/code>&lt;/a> (&lt;a class="link" href="https://docs.google.com/presentation/d/19rtiON2kMK_OAWEXtLhPW6IEmi74vEyXVWUno384S9Q/edit?usp=sharing" target="_blank" rel="noopener"
>&lt;em>slides&lt;/em>&lt;/a>)&lt;/li>
&lt;li>&amp;#x1f1ec;&amp;#x1f1e7; &lt;a class="link" href="https://youtu.be/KCp6vAdWOD0?t=601" target="_blank" rel="noopener"
>&lt;code>FalcOMG That's AWESOME - New Things, Fixed Things, and YOU (KubeCon Europe 2021)&lt;/code>&lt;/a> (&lt;a class="link" href="https://static.sched.com/hosted_files/kccnceu2021/a1/FalcOMG%20That%27s%20AWESOME%20-%20New%20Things%2C%20Fixed%20Things%2C%20and%20YOU%20%5BKubeCon%20%2B%20CloudNativeCon%20Europe%202021%5D.pdf" target="_blank" rel="noopener"
>&lt;em>slides&lt;/em>&lt;/a>)&lt;/li>
&lt;li>&amp;#x1f1ec;&amp;#x1f1e7; &lt;a class="link" href="https://www.youtube.com/watch?v=KYpkD-sMVmk" target="_blank" rel="noopener"
>&lt;code>Falcosidekick: building a micro service for enhancing, and distributing Falco Data (Cloud Native Data Management Days)&lt;/code>&lt;/a>&lt;/li>
&lt;li>&amp;#x1f1ec;&amp;#x1f1e7; &lt;a class="link" href="https://www.youtube.com/watch?v=F0qWkJ68lyE" target="_blank" rel="noopener"
>&lt;code>Detection and Reaction to threats in Kubernetes with Falco and a FaaS (Ekoparty 2021)&lt;/code>&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="2020">2020
&lt;/h3>&lt;ul>
&lt;li>&amp;#x1f1eb;&amp;#x1f1f7; &lt;a class="link" href="https://medium.com/electro-monkeys/46-la-s%C3%A9curit%C3%A9-dans-tous-ses-%C3%A9tats-d%C3%A9tection-de-comportements-ind%C3%A9sirables-gr%C3%A2ce-%C3%A0-falco-avec-5c3834ad28b8" target="_blank" rel="noopener"
>&lt;code>La s√©curit√© dans tous ses √©tats ‚Äî d√©tection de comportements ind√©sirables gr√¢ce √† Falco (Electro Monkeys)&lt;/code>&lt;/a>&lt;/li>
&lt;/ul></description></item></channel></rss>